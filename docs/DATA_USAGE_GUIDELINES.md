# データ利用ガイドライン

**バージョン**: 2.0
**最終更新**: 2025年10月28日
**対象**: ジョブメドレー求職者データ分析プロジェクト

---

## 目的

このドキュメントは、データ分析結果を報告書や会議資料で使用する際の指針を提供します。
**「観察的記述」と「推論的考察」を明確に区別**することで、誤解や混乱を防ぎます。

---

## データ利用の2つのステージ

### ステージ1: 観察的記述（Descriptive Statistics）

**定義**:
データに含まれる事実をそのまま記述すること。統計的推論は行わない。

**特徴**:
- ✅ サンプル数が1件でも事実として提示可能
- ✅ 件数・割合・期間を明示すれば十分
- ❌ 「傾向」「差異」「関係性」の言葉は使わない
- ❌ 因果関係の仮定は置かない

**品質検証**:
- **モード**: `validation_mode='descriptive'`
- **検証内容**: 入力整合性（欠損、異常値、重複）
- **警告**: データ不整合のみ（サンプルサイズは問わない）

**言葉遣い**:
| ✅ 適切 | ❌ 不適切 |
|---------|-----------|
| 「京都府には500件の希望者がいる」 | 「京都府は人気が高い傾向」 |
| 「20代は全体の30%を占める」 | 「20代が多い」 |
| 「緊急度5は545件（7.28%）」 | 「緊急度が高い傾向」 |

**出力ファイル例**:
- `phase1/Applicants.csv` - 申請者基本情報（個人データ）
- `phase1/DesiredWork.csv` - 希望勤務地詳細（事実記録）
- `phase1/AggDesired.csv` - 市区町村別希望者数（集計値）
- `phase8/EducationDistribution.csv` - 学歴分布（件数・割合）
- `phase10/UrgencyDistribution.csv` - 緊急度分布（件数・割合）

**品質レポート**:
- `phase1/QualityReport_Descriptive.csv`
- 信頼性レベル: `DESCRIPTIVE`（データ存在すればOK）
- 警告: `なし（観察的記述）`

---

### ステージ2: 推論的考察（Inferential Analysis）

**定義**:
観察したデータから傾向・関係性・パターンを読み取り、推論を行うこと。

**特徴**:
- ⚠️ 最小サンプル数が必要（グループ30件以上、全体100件以上推奨）
- ⚠️ クロス集計セルが小さすぎる場合は警告表示
- ✅ 「傾向が見られる」「差異がある」の言葉を使用可能
- ❌ 因果関係は置かない（相関≠因果）

**品質検証**:
- **モード**: `validation_mode='inferential'`
- **検証内容**: 統計的信頼性（サンプルサイズ、分散、クロス集計セル数）
- **警告**: 小サンプル、偏り、クロス集計の信頼性不足

**言葉遣い**:
| ✅ 適切 | ❌ 不適切 |
|---------|-----------|
| 「20代は緊急度が高い傾向が見られる」 | 「20代だから緊急度が高い」（因果） |
| 「大卒者は就業中の割合が高い」 | 「大卒者は就職しやすい」（因果） |
| 「○○市は高齢者の割合が多い」 | 「○○市は高齢者向け」（推測） |

**出力ファイル例**:
- `phase8/EducationAgeCross.csv` - 学歴×年齢のクロス集計（関係性推論）
- `phase10/UrgencyAgeCross.csv` - 緊急度×年齢のクロス集計（傾向分析）
- `phase10/UrgencyEmploymentCross.csv` - 緊急度×就業状態（関係性推論）

**品質レポート**:
- `phase8/QualityReport_Inferential.csv`
- `phase10/QualityReport_Inferential.csv`
- `OverallQualityReport_Inferential.csv`
- 信頼性レベル: `HIGH` / `MEDIUM` / `LOW` / `CRITICAL`
- 警告: `推論用最小グループ不足（1件 < 30件）`など

---

## 実務上の段階的プロセス

実際のデータ利用は、以下のように段階的に進化します：

```
【ステップ1】観察的記述
「まず事実を記述する」
　↓
例：「京都市中京区には500件、○○村には1件の希望者がいる」

【ステップ2】推論的考察
「次に傾向を読む」
　↓
例：「京都市中京区（n=500）では20代の割合が高い傾向が見られる」
　　「○○村（n=1）は参考データのみ」
```

### 注意点

1. **ステップ1→2への移行は明示的に**
   - 報告書では「以下は傾向分析です」と明記
   - 会議では「ここからは推論を含みます」と口頭で説明

2. **小サンプルの取り扱い**
   - 観察的記述: 「○○村: 1件」と件数を明記（事実なので提示OK）
   - 推論的考察: 「○○村（n=1）は統計的に不十分、参考データとして扱う」

3. **品質レポートの活用**
   - `QualityReport_Descriptive.csv`: データ整合性確認用
   - `QualityReport_Inferential.csv`: 統計的信頼性確認用
   - 報告書に添付し、データ品質を透明化

---

## Phase別の利用目的

| Phase | ファイル | 利用目的 | 品質検証モード |
|-------|----------|---------|---------------|
| **Phase 1** | Applicants.csv | 個人データ（事実） | Descriptive |
| | DesiredWork.csv | 希望勤務地詳細（事実） | Descriptive |
| | AggDesired.csv | 市区町村別集計（事実） | Descriptive |
| **Phase 8** | EducationDistribution.csv | 学歴分布（事実） | Descriptive相当 |
| | EducationAgeCross.csv | 学歴×年齢（傾向） | Inferential |
| | GraduationYearDistribution.csv | 卒業年分布（事実） | Descriptive相当 |
| **Phase 10** | UrgencyDistribution.csv | 緊急度分布（事実） | Descriptive相当 |
| | UrgencyAgeCross.csv | 緊急度×年齢（傾向） | Inferential |
| | UrgencyEmploymentCross.csv | 緊急度×就業（傾向） | Inferential |

---

## Phase 7, 8, 10データの特別な利用制限 🚨

### 背景

Phase 7（高度分析）、Phase 8（キャリア・学歴分析）、Phase 10（転職意欲・緊急度分析）のデータは、品質レポートで大量のCRITICAL警告が表示されます。これは、市区町村レベルやキャリア詳細レベルでの細分化により、各グループのサンプルサイズが非常に小さくなるためです。

### Phase 7の利用制限

**品質状況**:
- 24カラム中、23カラムがCRITICAL判定
- 最小グループサイズ: 1件～7件（<30件）
- genderのみHIGH判定

**許可される使用方法**:
- ✅ **観察的記述のみ**:
  - 「京都府京都市中京区: 818件」（事実）
  - 「国家資格保有者: 30件（3.7%）」（集計値）
  - 「平均年齢: 46.9歳」（統計量）
- ❌ **推論的考察は禁止**:
  - 「京都市中京区は20代が多い傾向」（統計的に不十分）
  - 「資格保有者は年齢が高い傾向」（サンプル不足）

**対応方法**:
```markdown
## Phase 7データの正しい使い方

### ✅ 正しい例
「京都府京都市中京区には818件の希望者がおり、そのうち国家資格保有者は30件（3.7%）、平均年齢は46.9歳でした（観察的記述）。」

### ❌ 誤った例
「京都市中京区は国家資格保有者の割合が高い傾向が見られます（推論的考察）。」
→ n=30件は推論には不十分。事実の記述のみに留める。
```

### Phase 8の利用制限

**品質状況**:
- careerカラム: 1,627ユニーク値、最小グループ2件（<30件）
- age_groupのみHIGH判定

**許可される使用方法**:
- ✅ **キャリア分布の事実記述**:
  - 「(高等学校): 172件、平均年齢46.9歳」（事実）
  - 「(大学): 45件、平均資格数2.5個」（統計量）
- ❌ **キャリア別の傾向分析は禁止**:
  - 「高校卒業者は資格数が少ない傾向」（サンプル不足）

**推奨対応**:
1. **表記ゆれの正規化**: "普通科(高等学校)(1990年卒業)" → "普通科(高等学校)"
2. **年齢層でのグループ化**: 個別キャリアではなく、年齢層×キャリア大分類で分析

### Phase 10の利用制限

**品質状況**:
- UrgencyAgeCross: 24件～40件のクロス集計（<100件推奨）
- 最小グループサイズ: 10件（<30件）

**許可される使用方法**:
- ✅ **緊急度分布の事実記述**:
  - 「A: 高い: 148件（2.0%）」（事実）
  - 「D: 低い: 3,229件（43.1%）」（集計値）
- ✅ **全体傾向の推論**（サンプル数十分な場合）:
  - 「全体（n=7,487）では、緊急度Dが最も多い（43.1%）」（推論OK）
- ⚠️ **年齢層別の詳細分析は注意が必要**:
  - 「20代×緊急度A（n=10）は参考データのみ」（サンプル不足を明記）

**対応方法**:
```markdown
## Phase 10データの正しい使い方

### ✅ 正しい例
「緊急度Aは148件（2.0%）、Bは995件（13.3%）、Cは3,115件（41.6%）、Dは3,229件（43.1%）でした（観察的記述）。

全体傾向としては、緊急度が低い求職者が大半を占めることが示唆されます（n=7,487）。ただし、年齢層別の詳細分析では一部のセルでサンプル数が少なく（最小n=10）、これらは参考データとして扱います。」

### ❌ 誤った例
「20代は緊急度が高い傾向が見られます。」
→ 20代×緊急度Aのセルはn=10件で統計的に不十分。
```

### 共通の対応指針

1. **品質レポートを必ず確認**:
   - `P7_QualityReport_Inferential.csv`
   - `P8_QualityReport_Inferential.csv`
   - `P10_QualityReport_Inferential.csv`

2. **CRITICAL警告のカラムは推論禁止**:
   - 件数のみ記載（観察的記述）
   - 「参考データ」と明記

3. **報告書での表記**:
   ```markdown
   ※ このデータは観察的記述として提示しています。サンプルサイズが小さいため、傾向分析には使用していません。
   ```

4. **解決策**:
   - データを粗いグループに統合（市区町村→都道府県、キャリア詳細→大分類）
   - 十分なサンプルサイズを確保してから推論を行う

---

## 報告書テンプレート例

### 観察的記述セクション

```markdown
## 希望勤務地分布（観察的記述）

全7,487件の求職者データにおける希望勤務地の分布は以下の通りです：

| 都道府県 | 市区町村 | 件数 | 全体割合 |
|----------|----------|------|----------|
| 京都府 | 京都市中京区 | 500 | 6.7% |
| 京都府 | 京都市下京区 | 300 | 4.0% |
| 京都府 | ○○村 | 1 | 0.01% |

※ 観察的記述：データに含まれる事実をそのまま記載。件数が1件の地域も事実として提示。
```

### 推論的考察セクション

```markdown
## 年齢層×緊急度の関係分析（推論的考察）

### 前提条件
- 総サンプル数: 7,487件
- 品質スコア: 90.0/100点（EXCELLENT）
- 信頼性: HIGH（統計的に十分なサンプルサイズ）

### 分析結果
20代では緊急度5（今すぐに）の割合が全体平均7.28%に対して12.5%と高い傾向が見られます（n=1,200）。

### 注意事項
- この分析は相関関係を示すものであり、因果関係を示すものではありません
- 一部の年齢層ではサンプル数が少なく、参考データとして扱います
- 詳細は添付の品質レポート（QualityReport_Inferential.csv）を参照

※ 推論的考察：傾向・関係性の推論を含みます。
```

---

## 品質レポートの読み方

### Descriptive（観察的記述）モード

```csv
カラム名,有効データ数,ユニーク値数,最小グループサイズ,信頼性レベル,警告
residence_muni,7487,307,1,DESCRIPTIVE,なし（観察的記述）
```

**解釈**:
- 307の市区町村に7,487件の希望者が分布
- 最小グループサイズは1件（どこかの市区町村に1件のみ）
- **警告なし**: 事実の記述として使用可能（「○○村: 1件」と明記すればOK）

### Inferential（推論的考察）モード

```csv
カラム名,有効データ数,ユニーク値数,最小グループサイズ,信頼性レベル,警告
age,7487,72,1,CRITICAL,推論用最小グループ不足（1件 < 30件）
```

**解釈**:
- 72の年齢に7,487件が分布
- 最小グループサイズは1件（どこかの年齢に1件のみ）
- **CRITICAL警告**: 統計的推論には不十分（その年齢は傾向分析に使用不可）

**対応**:
- 年齢層でグループ化（20代以下、30代、40代、50代、60代以上）
- グループ化後は各年齢層30件以上確保
- 小サンプル年齢は「参考データ」として脚注に記載

---

## よくある質問（FAQ）

### Q1: 「京都府○○村: 1件」は提示できますか？

**A1**: はい、**観察的記述として提示可能**です。

- ✅ 「京都府○○村には1件の希望者がいる」（事実）
- ✅ 「全7,487件中、○○村は0.01%を占める」（事実）
- ❌ 「○○村は人気が低い」（推論・評価は不可）

### Q2: サンプル数1件の地域でクロス集計できますか？

**A2**: いいえ、**推論的考察には使用できません**。

- ❌ 「○○村（n=1）は20代が多い傾向」（統計的に不十分）
- ✅ 「○○村（n=1）は参考データのみ、傾向分析には含めない」（適切）

**解決策**:
- 地域をグループ化（市町村→都道府県、または人口規模別）
- 最小サンプル30件以上を確保

### Q3: Phase 8の「EducationDistribution.csv」は事実記述ですか？

**A3**: はい、**学歴分布は事実記述**です。

```csv
education_level,人数,割合
なし,5224,69.77
高校,835,11.15
大学,750,10.02
```

- ✅ 「高校卒業者は835件（11.15%）」（事実）
- ❌ 「高校卒業者は少ない傾向」（評価・推論は不可）

### Q4: 品質スコアが70点でも使用できますか？

**A4**: はい、ただし**注意事項を明記**してください。

- 70-79点: GOOD（一部のカラムに注意が必要）
- 80-89点: EXCELLENT（そのまま使用可能）
- 90点以上: EXCELLENT（統計的に非常に信頼できる）

**70点の場合の対応**:
- 品質レポートで警告があるカラムを確認
- CRITICAL警告のカラムは傾向分析に使用しない
- 報告書に「一部データは参考値」と明記

---

## チェックリスト

報告書・会議資料作成時に以下を確認してください：

### 観察的記述セクション

- [ ] 件数・割合・期間を明示
- [ ] 「傾向」「差異」の言葉を使用していない
- [ ] サンプル数1件のデータも事実として記載（件数明記）
- [ ] 品質レポート（Descriptive）を添付

### 推論的考察セクション

- [ ] 「傾向が見られる」「関係性がある」など慎重な言葉遣い
- [ ] サンプルサイズを明記（n=1,200など）
- [ ] 品質スコアを明記（90.0/100点など）
- [ ] CRITICAL警告のデータは除外または「参考値」と明記
- [ ] 因果関係を主張していない
- [ ] 品質レポート（Inferential）を添付

### 全体

- [ ] 「観察的記述」と「推論的考察」のセクションを分離
- [ ] 各セクションの冒頭で利用目的を明記
- [ ] サンプルサイズ不足のデータに脚注を付与

---

## 参考資料

- `data_quality_validator.py` - 品質検証ロジック実装
- `run_complete_v2.py` - Phase別の検証モード設定
- `QualityReport_Descriptive.csv` - 観察的記述用品質レポート
- `QualityReport_Inferential.csv` - 推論的考察用品質レポート

---

## 改訂履歴

| バージョン | 日付 | 変更内容 |
|-----------|------|---------|
| 1.0 | 2025-10-26 | 初版作成 |
| 2.0 | 2025-10-28 | 観察的記述・推論的考察の分離、品質検証モード追加 |
| 2.1 | 2025-10-29 | Phase 7, 8, 10の特別な利用制限セクション追加（CRITICAL警告対応） |
