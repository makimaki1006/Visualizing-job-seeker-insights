# 最終開発計画書（要件定義書準拠版）

**作成日**: 2025年11月13日
**基準ドキュメント**: REQUIREMENTS_SPECIFICATION.md (PRD-MAPCOMPLETE-REFLEX-001)
**開発期間**: 3日間（2025年11月13日～15日）
**ステータス**: 🎯 実行可能

---

## 📋 エグゼクティブサマリー

### 要件定義書からの重要事項

| 項目 | 要件定義書の記載 | 実装方針 |
|------|---------------|---------|
| **開発期間** | 3日間 | **厳守** |
| **対象** | GAS全機能完全再現 | **Must要件を優先実装** |
| **完成度基準** | GAS同等以上のUI/UX | **80%完成のGASを基準とする** |
| **パフォーマンス** | 初回ロード5秒以内 | 必須達成 |
| **ユーザー数** | 10ユーザー同時接続 | 必須達成 |

### 現実的な判断

**GASを100%完成させる時間的余裕はない（15-17時間必要）**

**解決策**:
- **GAS 80%完成版を「現状の仕様」として扱う**
- **Phase 5の7タスクは「Could要件」として後回し**
- **Must要件（10タブの基本機能）を3日間で完全実装**

---

## 🎯 MoSCoW分析に基づく優先順位

### Must（必須 - 3日間で実装）🔥

#### M-001: パフォーマンス改善
- 初回ロード: 98秒 → 5秒以内 ✅
- タブ切替: 5-10秒 → 0.1秒以内 ✅

#### M-002: 10ユーザー同時利用
- セッション独立 ✅
- データ混在防止 ✅

#### M-003: GAS全機能再現（80%基準）
**10タブの基本機能**:
1. ✅ サマリータブ（メトリックカード）
2. 📊 年齢×性別タブ（Plotlyグラフ）
3. 🎯 ペルソナタブ（Plotlyグラフ）
4. 🌊 フローマップ（Sankeyダイアグラム）
5. 📈 需給ギャップ（複合グラフ）
6. 💎 希少人材（散布図）
7. 🏆 競争プロファイル（レーダーチャート）
8. 💼 キャリア×年齢（ヒートマップ）
9. ⏰ 緊急度×年齢（積み上げ棒グラフ）
10. 💼 緊急度×就業（積み上げ棒グラフ）

**基本機能の定義**:
- 各タブで主要グラフ表示
- 都道府県フィルタリング動作
- データテーブル表示
- 基本的なインタラクティブ機能

#### M-004: ビジュアル品質
- Plotlyでグラフ美麗化
- レスポンシブデザイン
- GAS同等のレイアウト

---

### Could（任意 - 3日後に実装）🟡

#### C-001: GAS Phase 5の7タスク
**3日間では実装しない、後日対応**:
- T-001: 総合概要タブの市町村フィルタリング
- T-002: キャリア分析タブの市町村フィルタリング
- T-003: 緊急度分析タブの市町村フィルタリング
- T-004: ペルソナ絞り込みボタン
- T-005: クロス分析タブの詳細実装
- T-006: フロー分析タブの詳細実装
- T-007: UI細部調整

**理由**:
- GAS Phase 5実装に15-17時間必要
- 3日間ではReflex/Dash実装が間に合わない
- **まずMust要件を完成させることを優先**

#### C-002: データダウンロード機能
#### C-003: 複数地域比較機能

---

## 📅 3日間開発スケジュール

### Day 1: Reflex基本実装（8時間）

#### 午前（4時間）
**目標**: タブ1-3実装

1. **サマリータブ強化**（1時間）
   - メトリックカード4枚（完了済み）
   - レイアウト調整

2. **年齢×性別タブ**（1.5時間）
   - AGE_GENDER row_type データ取得
   - Plotly棒グラフ実装
   - 性別で色分け

3. **ペルソナタブ**（1.5時間）
   - PERSONA_MUNI row_type データ取得
   - Plotly棒グラフ実装
   - 降順ソート

#### 午後（4時間）
**目標**: タブ4-6実装

4. **フロー分析タブ**（1.5時間）
   - FLOW row_type データ取得
   - Plotly Sankeyダイアグラム実装
   - 流入・流出表示

5. **需給ギャップタブ**（1.5時間）
   - GAP row_type データ取得
   - Plotly複合グラフ実装
   - 需要・供給・ギャップ表示

6. **希少人材タブ**（1時間）
   - RARITY row_type データ取得
   - Plotly散布図実装
   - 希少度スコア可視化

**Day 1成果**: Reflex 6タブ完成（60%）

---

### Day 2: Reflex完成 + Dash基本実装（8時間）

#### 午前（4時間）
**目標**: Reflexタブ7-10実装

7. **競争プロファイルタブ**（1時間）
   - COMPETITION row_type データ取得
   - Plotlyレーダーチャート実装

8. **キャリア×年齢タブ**（1時間）
   - CAREER_CROSS row_type データ取得
   - Plotlyヒートマップ実装

9. **緊急度×年齢タブ**（1時間）
   - URGENCY_AGE row_type データ取得
   - Plotly積み上げ棒グラフ実装

10. **緊急度×就業タブ**（1時間）
    - URGENCY_EMPLOYMENT row_type データ取得
    - Plotly積み上げ棒グラフ実装

**Reflex完成**: 10タブ完全実装 ✅

#### 午後（4時間）
**目標**: Dashタブ1-4実装

Reflexで実装したロジックをDashに移植
- タブ1-2（サマリー、年齢×性別）（1.5時間）
- タブ3-4（ペルソナ、フロー）（2.5時間）

**Day 2成果**: Reflex完成、Dash 40%

---

### Day 3: Dash完成 + 比較評価 + デプロイ（8時間）

#### 午前（4時間）
**目標**: Dashタブ5-10実装

- タブ5-7（ギャップ、希少人材、競争）（2時間）
- タブ8-10（キャリア、緊急度×2）（2時間）

**Dash完成**: 10タブ完全実装 ✅

#### 午後（4時間）
**目標**: 比較評価 + 最終選定 + デプロイ

1. **UI/UX比較評価**（1時間）
   - GAS 80%版、Reflex、Dashを並べて比較
   - スクリーンショット撮影
   - 操作感確認

2. **パフォーマンステスト**（1時間）
   - 初回ロード時間測定
   - タブ切替速度測定
   - 10ユーザー同時接続テスト

3. **最終選定**（0.5時間）
   - Reflex vs Dashの評価
   - 最終決定

4. **Renderデプロイ**（1.5時間）
   - 選定フレームワークをデプロイ
   - 本番環境テスト
   - URL共有

**Day 3成果**: 本番デプロイ完了 🎉

---

## ✅ 成功基準（要件定義書準拠）

### Must達成基準

| 要件ID | 基準 | 測定方法 | 目標 |
|--------|------|---------|------|
| **M-001** | 初回ロード5秒以内 | Chrome DevTools | ✅ 必須 |
| **M-002** | 10ユーザー同時接続成功 | Locust負荷テスト | ✅ 必須 |
| **M-003** | 10タブ基本機能実装 | 手動確認 | ✅ 必須 |
| **M-004** | ビジュアル品質GAS同等 | 採用担当者評価 | ✅ 必須 |

### Should達成基準（ベストエフォート）

| 要件ID | 基準 | ステータス |
|--------|------|-----------|
| **S-001** | 構造化コード | ✅ 達成見込み |
| **S-002** | テスト自動化 | 🟡 一部のみ |
| **S-003** | セッションタイムアウト | 🟡 Reflexデフォルト |

### Could達成基準（3日後）

| 要件ID | 基準 | 実装時期 |
|--------|------|---------|
| **C-001** | GAS Phase 5の7タスク | Week 2以降 |
| **C-002** | データダウンロード | Week 3以降 |

---

## 🚧 リスク管理

### リスク1: 3日間で10タブ完成できない
**確率**: 中（30%）
**影響**: 高
**軽減策**:
- Day 1午後までにReflex 6タブ完成を必達
- 遅延時はDash実装を省略（Reflexのみで完成）

### リスク2: UI/UX品質がGASに劣る
**確率**: 低（20%）
**影響**: 高
**軽減策**:
- Plotlyで高品質グラフ実装
- Chakra UI/Bootstrapでレイアウト調整
- GAS参照しながら実装

### リスク3: パフォーマンス目標未達成
**確率**: 低（15%）
**影響**: 中
**軽減策**:
- データキャッシング実装
- 遅延ロード実装
- 軽量化（不要データ削除）

---

## 🎯 実装の判断基準

### GAS 80%版との比較

**再現する機能**:
- ✅ 10タブの基本表示
- ✅ 都道府県フィルタリング
- ✅ 主要グラフ表示
- ✅ データテーブル表示
- ✅ メトリックカード

**再現しない機能（Phase 5未実装部分）**:
- ❌ 市町村フィルタリング（3タブで未動作）
- ❌ ペルソナ絞り込みボタン
- ❌ クロス分析タブの詳細機能
- ❌ フロー分析タブの詳細機能

**理由**:
**「GAS 80%版を100%再現することが目標」**
→ Phase 5未実装部分は後日対応

---

## 📊 工数見積もり

### Reflex実装
| タブ | 推定工数 | 累計 |
|------|---------|------|
| 1. サマリー | 完了 | - |
| 2. 年齢×性別 | 1.5h | 1.5h |
| 3. ペルソナ | 1.5h | 3h |
| 4. フロー | 1.5h | 4.5h |
| 5. ギャップ | 1.5h | 6h |
| 6. 希少人材 | 1h | 7h |
| 7. 競争 | 1h | 8h |
| 8. キャリア | 1h | 9h |
| 9. 緊急度×年齢 | 1h | 10h |
| 10. 緊急度×就業 | 1h | 11h |
| **合計** | **11時間** | - |

### Dash実装
- Reflexロジック移植: 7時間
- 調整・テスト: 1時間
- **合計**: 8時間

### その他
- 比較評価: 1時間
- パフォーマンステスト: 1時間
- 最終選定: 0.5時間
- Renderデプロイ: 1.5時間
- **合計**: 4時間

### 総工数
**Reflex 11h + Dash 8h + その他 4h = 23時間**

**3日間（24時間）で完成可能** ✅

---

## 🚀 次のアクション

### 即座に開始（Day 1午前）

#### Step 1: Reflex年齢×性別タブ実装
```bash
cd reflex_app
reflex run
```

**実装内容**:
1. AGE_GENDER row_typeデータ取得
2. Plotly棒グラフ作成
3. 性別で色分け（男性：青、女性：ピンク）
4. タブに配置

**成果物**: 動作する年齢×性別タブ

---

#### Step 2: Reflexペルソナタブ実装
**実装内容**:
1. PERSONA_MUNI row_typeデータ取得
2. Plotly棒グラフ作成
3. 人数降順ソート
4. タブに配置

---

## ✅ 最終確認

### この計画で正しいですか？

1. ✅ **3日間でReflex + Dash完成を目指す**
2. ✅ **GAS 80%版を基準として再現**
3. ✅ **Phase 5の7タスクは後回し（Could要件）**
4. ✅ **Must要件（10タブ基本機能）を優先実装**
5. ✅ **初回ロード5秒、10ユーザー同時接続を必達**

この方針で進めてよろしいですか？

---

**最優先ミッション: Reflex年齢×性別タブ実装開始** 🚀
