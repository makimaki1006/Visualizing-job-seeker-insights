# GAS Phase 7 E2Eテストガイド

**目的**: Python → Google Drive → GAS → 可視化の完全なワークフローをテストする

**テスト日**: 未実施
**テスト担当者**: ユーザー実施待ち
**推定所要時間**: 30-45分

---

## 📋 テスト前チェックリスト

### 必須条件

- [ ] Pythonスクリプトが正常に動作する
- [ ] Googleアカウントにアクセスできる
- [ ] Googleスプレッドシートを作成・編集できる
- [ ] Google Driveにファイルをアップロードできる
- [ ] Google Apps Script (GAS)エディタにアクセスできる

### 準備するもの

- [ ] テストデータCSV（推奨: `統合_求職者情報京都_介護 (1).csv`）
- [ ] GASプロジェクト（新規または既存）
- [ ] ブラウザ（Chrome推奨）

---

## 🚀 Phase 1: Pythonでテストデータ生成

### 1-1. テストデータ選択

**推奨データ**:
```
C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\data\input\統合_求職者情報京都_介護 (1).csv
```

**理由**:
- 京都府のデータ（地域が限定されているため処理が速い）
- 介護職種（Phase 7の全機能が動作する）
- 適度なデータサイズ

### 1-2. Python実行

**コマンド**:
```bash
cd "C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\python_scripts"
python run_complete.py
```

**GUIダイアログ操作**:
1. ファイル選択ダイアログが表示される
2. `統合_求職者情報京都_介護 (1).csv` を選択
3. 「開く」をクリック

### 1-3. 実行結果確認

**コンソール出力例**:
```
[PHASE7] Phase 7: 高度分析機能（NEW!）
   [OK] Phase 7完了 (5ファイル)
```

**出力ファイル確認**:
```bash
cd "C:\Users\fuji1\OneDrive\Pythonスクリプト保管"
dir gas_output_phase7
```

**期待される5ファイル**:
```
SupplyDensityMap.csv          # 人材供給密度マップ
QualificationDistribution.csv # 資格別人材分布
AgeGenderCrossAnalysis.csv    # 年齢層×性別クロス分析
MobilityScore.csv             # 移動許容度スコアリング
DetailedPersonaProfile.csv    # ペルソナ詳細プロファイル
```

### 1-4. テスト判定基準

| 項目 | 合格基準 | 確認方法 |
|------|----------|----------|
| 実行完了 | エラーなし | コンソール出力に `[ERROR]` がない |
| ファイル生成 | 5ファイル | `dir gas_output_phase7` で5ファイル確認 |
| ファイルサイズ | 0バイト超 | 各CSVが空でない |
| CSV形式 | 正常 | テキストエディタで開いてヘッダー確認 |

**Phase 1 完了**: ✅ / ❌

---

## 📤 Phase 2: Google Driveにアップロード

### 2-1. Google Driveを開く

1. ブラウザで [Google Drive](https://drive.google.com) を開く
2. Googleアカウントにログイン

### 2-2. フォルダ作成

**方法1: GASメニューから作成（推奨）**

この方法は後で使用するので、今はスキップ可能。

**方法2: 手動作成**

1. Google Driveのルートディレクトリで右クリック
2. 「新しいフォルダ」を選択
3. フォルダ名: `gas_output_phase7`
4. 「作成」をクリック

### 2-3. CSVファイルをアップロード

1. 作成した `gas_output_phase7` フォルダを開く
2. 「ファイルをアップロード」をクリック
3. 以下の5ファイルを選択:
   ```
   C:\Users\fuji1\OneDrive\Pythonスクリプト保管\gas_output_phase7\*.csv
   ```
4. アップロード完了を待つ

### 2-4. アップロード確認

**Google Drive内で確認**:
```
gas_output_phase7/
├── SupplyDensityMap.csv
├── QualificationDistribution.csv
├── AgeGenderCrossAnalysis.csv
├── MobilityScore.csv
└── DetailedPersonaProfile.csv
```

### 2-5. テスト判定基準

| 項目 | 合格基準 | 確認方法 |
|------|----------|----------|
| フォルダ作成 | 存在する | Google Driveで確認 |
| ファイル数 | 5ファイル | フォルダ内を確認 |
| ファイル名 | 正しい | 上記5つのファイル名と一致 |
| アクセス権 | 読み取り可能 | ファイルをプレビューできる |

**Phase 2 完了**: ✅ / ❌

---

## 📝 Phase 3: GASプロジェクトにコードアップロード

### 3-1. Googleスプレッドシートを作成

1. Google Driveで「新規」→「Googleスプレッドシート」
2. シート名: `Phase 7 E2Eテスト` (任意)

### 3-2. Apps Scriptエディタを開く

1. スプレッドシートのメニュー: `拡張機能` → `Apps Script`
2. 新しいタブでApps Scriptエディタが開く

### 3-3. GASファイルをアップロード

**必要な7ファイル**:

#### ファイル1: `Phase7AutoImporter.gs`
**場所**: `C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\gas_files\scripts\Phase7AutoImporter.gs`

**操作**:
1. Apps Scriptエディタで「＋」→「スクリプト」
2. ファイル名: `Phase7AutoImporter`
3. コードをコピー＆ペースト

#### ファイル2: `Phase7SupplyDensityViz.gs`
**場所**: `C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\gas_files\scripts\Phase7SupplyDensityViz.gs`

**操作**: 同様に追加

#### ファイル3: `Phase7QualificationDistViz.gs`
**場所**: `C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\gas_files\scripts\Phase7QualificationDistViz.gs`

#### ファイル4: `Phase7AgeGenderCrossViz.gs`
**場所**: `C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\gas_files\scripts\Phase7AgeGenderCrossViz.gs`

#### ファイル5: `Phase7MobilityScoreViz.gs`
**場所**: `C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\gas_files\scripts\Phase7MobilityScoreViz.gs`

#### ファイル6: `Phase7PersonaProfileViz.gs`
**場所**: `C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\gas_files\scripts\Phase7PersonaProfileViz.gs`

#### ファイル7: `Phase7CompleteDashboard.gs`
**場所**: `C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\gas_files\scripts\Phase7CompleteDashboard.gs`

#### ファイル8: `Phase7CompleteMenuIntegration.gs`
**場所**: `C:\Users\fuji1\OneDrive\Pythonスクリプト保管\job_medley_project\gas_files\scripts\Phase7CompleteMenuIntegration.gs`

### 3-4. プロジェクト構成確認

**Apps Scriptエディタの左サイドバー**:
```
プロジェクト
├── Phase7AutoImporter.gs
├── Phase7SupplyDensityViz.gs
├── Phase7QualificationDistViz.gs
├── Phase7AgeGenderCrossViz.gs
├── Phase7MobilityScoreViz.gs
├── Phase7PersonaProfileViz.gs
├── Phase7CompleteDashboard.gs
└── Phase7CompleteMenuIntegration.gs
```

### 3-5. 保存とデプロイ

1. 「プロジェクトを保存」アイコンをクリック（💾）
2. スプレッドシートをリロード（F5）
3. メニューバーに「📊 データ処理」が表示されることを確認

### 3-6. テスト判定基準

| 項目 | 合格基準 | 確認方法 |
|------|----------|----------|
| ファイル追加 | 8ファイル | Apps Scriptエディタで確認 |
| 構文エラー | なし | 保存時にエラーが出ない |
| メニュー表示 | 表示される | スプレッドシートのメニューバー |

**Phase 3 完了**: ✅ / ❌

---

## 🔄 Phase 4: GAS自動インポート機能テスト

### 4-1. クイックインポート実行

**操作**:
1. スプレッドシートのメニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `📥 データインポート` → `🚀 クイックインポート（推奨）`
2. 実行を許可（初回のみ）
3. ダイアログが表示されるまで待つ

### 4-2. 期待される動作

**ダイアログ表示内容**:
```
インポート完了

5ファイルを正常にインポートしました:

✅ Phase7_SupplyDensity: 50行
✅ Phase7_QualificationDist: 15行
✅ Phase7_AgeGenderCross: 30行
✅ Phase7_MobilityScore: 500行
✅ Phase7_PersonaProfile: 5行

データ検証: すべて正常
```

### 4-3. シート確認

**スプレッドシート下部のタブ**:
```
├── Phase7_SupplyDensity
├── Phase7_QualificationDist
├── Phase7_AgeGenderCross
├── Phase7_MobilityScore
└── Phase7_PersonaProfile
```

### 4-4. データ内容確認

**Phase7_SupplyDensity シート**:
```
| 市区町村 | 総求職者数 | 採用難易度ランク | 総合スコア | 女性比率 | 資格保有率 | ... |
|---------|----------|----------------|-----------|---------|----------|-----|
| 京都市中京区 | 123 | A | 0.75 | 0.68 | 0.82 | ... |
| 京都市下京区 | 98  | B | 0.65 | 0.72 | 0.78 | ... |
```

### 4-5. テスト判定基準

| 項目 | 合格基準 | 確認方法 |
|------|----------|----------|
| インポート成功 | 成功ダイアログ表示 | ダイアログメッセージ |
| シート作成 | 5シート | スプレッドシート下部タブ |
| データ存在 | 各シートにデータあり | 各シートを開いて確認 |
| ヘッダー | 正しい | 1行目がカラム名 |
| データ型 | 正しい | 数値列が数値、文字列列が文字列 |

**Phase 4 完了**: ✅ / ❌

---

## 📊 Phase 5: 個別可視化機能テスト

### 5-1. 人材供給密度マップ

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `📊 個別分析` → `🗺️ 人材供給密度マップ`
2. ダイアログが開くまで待つ

**確認項目**:
- [ ] バブルチャートが表示される
- [ ] ランク別に色分けされている（金S、青A、緑B、橙C、灰D）
- [ ] ランク別円グラフが表示される
- [ ] 統計サマリーカードが3枚表示される
- [ ] 詳細テーブルが表示される
- [ ] データが正しく表示されている

**スクリーンショット**: （必要に応じて撮影）

### 5-2. 資格別人材分布

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `📊 個別分析` → `🎓 資格別人材分布`

**確認項目**:
- [ ] 統計サマリーカード（3枚、グラデーション背景）
- [ ] 横棒グラフ（保有者数降順）
- [ ] 詳細テーブル（希少地域バッジ付き）
- [ ] データが正しく表示されている

### 5-3. 年齢層×性別クロス分析

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `📊 個別分析` → `👥 年齢層×性別クロス分析`

**確認項目**:
- [ ] 積み上げ棒グラフ（地域別構成比）
- [ ] 支配的セグメント円グラフ
- [ ] ダイバーシティスコアチャート
- [ ] スコア別背景色テーブル（高=緑、中=黄、低=赤）
- [ ] データが正しく表示されている

### 5-4. 移動許容度スコアリング

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `📊 個別分析` → `🚗 移動許容度スコアリング`

**確認項目**:
- [ ] ヒストグラム（スコア分布）
- [ ] レベル別円グラフ（A/B/C/D）
- [ ] 散布図（希望地数 × 最大距離）
- [ ] 居住地別TOP10テーブル
- [ ] データが正しく表示されている

### 5-5. ペルソナ詳細プロファイル

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `📊 個別分析` → `📊 ペルソナ詳細プロファイル`

**確認項目**:
- [ ] レーダーチャート（6軸比較）
- [ ] ペルソナカード（5色グラデーション背景）
- [ ] 構成比円グラフ
- [ ] 比較テーブル
- [ ] データが正しく表示されている

### 5-6. テスト判定基準

| 項目 | 合格基準 | 確認方法 |
|------|----------|----------|
| ダイアログ表示 | 5機能すべて表示 | 各メニューから実行 |
| グラフ描画 | すべて正常 | 視覚的に確認 |
| データ表示 | 正確 | 数値を確認 |
| UI美観 | グラデーション等 | 視覚的に確認 |
| エラー | なし | ブラウザコンソール確認 |

**Phase 5 完了**: ✅ / ❌

---

## 🎯 Phase 6: 統合ダッシュボードテスト

### 6-1. ダッシュボード起動

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `🎯 完全統合ダッシュボード`
2. ダイアログが開くまで待つ（初回は10-15秒程度）

### 6-2. タブ切り替えテスト

**確認項目**:
- [ ] 📋 概要タブ: KPIカード×5が表示される
- [ ] 🗺️ 人材供給密度マップタブ: バブルチャート等が表示される
- [ ] 🎓 資格別人材分布タブ: 横棒グラフ等が表示される
- [ ] 👥 年齢層×性別クロス分析タブ: 積み上げ棒グラフ等が表示される
- [ ] 🚗 移動許容度スコアリングタブ: ヒストグラム等が表示される
- [ ] 📊 ペルソナ詳細プロファイルタブ: レーダーチャート等が表示される

### 6-3. UIデザイン確認

**確認項目**:
- [ ] 紫のグラデーション背景
- [ ] タブボタンのアクティブ状態（青い下線）
- [ ] スムーズなタブ切り替え
- [ ] レスポンシブグリッドレイアウト
- [ ] シャドウエフェクト

### 6-4. KPIカード確認

**概要タブで確認**:
- [ ] 👥 総求職者数
- [ ] 🗺️ 分析対象地域数
- [ ] 🎓 資格カテゴリ数
- [ ] 🚗 平均移動許容度
- [ ] 📊 ペルソナセグメント数

**数値の妥当性**: データと一致しているか確認

### 6-5. パフォーマンス確認

**確認項目**:
- [ ] 初回ロード時間: 15秒以内
- [ ] タブ切り替え時間: 1秒以内（2回目以降）
- [ ] グラフ描画時間: 3秒以内
- [ ] ブラウザのフリーズ: なし

### 6-6. テスト判定基準

| 項目 | 合格基準 | 確認方法 |
|------|----------|----------|
| ダッシュボード起動 | 正常 | ダイアログ表示 |
| タブ切り替え | 6タブすべて動作 | 各タブをクリック |
| グラフ表示 | すべて表示 | 視覚的に確認 |
| UI美観 | グラデーション等 | 視覚的に確認 |
| パフォーマンス | 快適 | 体感速度 |
| エラー | なし | ブラウザコンソール |

**Phase 6 完了**: ✅ / ❌

---

## 🔧 Phase 7: データ管理機能テスト

### 7-1. データ検証

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `🔧 データ管理` → `✅ データ検証`

**期待される結果**:
```
Phase 7データ検証結果

✅ Phase7_SupplyDensity: 50行、9カラム
✅ Phase7_QualificationDist: 15行、4カラム
✅ Phase7_AgeGenderCross: 30行、6カラム
✅ Phase7_MobilityScore: 500行、7カラム
✅ Phase7_PersonaProfile: 5行、12カラム

すべてのシートが正常です。
```

### 7-2. データサマリー

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `🔧 データ管理` → `📊 データサマリー`

**期待される結果**:
```
Phase 7データサマリー

Phase7_SupplyDensity: 50レコード
Phase7_QualificationDist: 15レコード
Phase7_AgeGenderCross: 30レコード
Phase7_MobilityScore: 500レコード
Phase7_PersonaProfile: 5レコード

合計: 600レコード
```

### 7-3. ランク別内訳エクスポート

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `🔧 データ管理` → `📤 ランク別内訳エクスポート`

**確認項目**:
- [ ] 新しいシート「Phase7_RankBreakdown」が作成される
- [ ] ランク別の詳細データが表示される
- [ ] データが正しい

### 7-4. 全データクリア

**操作**:
1. メニュー: `📊 データ処理` → `📈 Phase 7高度分析` → `🔧 データ管理` → `🧹 全データクリア`
2. 確認ダイアログで「はい」をクリック

**確認項目**:
- [ ] 5つのPhase 7シートが削除される
- [ ] 他のシートは残る
- [ ] 削除完了メッセージが表示される

**注意**: この操作は最後に実行（再インポートが必要になる）

### 7-5. テスト判定基準

| 項目 | 合格基準 | 確認方法 |
|------|----------|----------|
| データ検証 | すべて正常 | ダイアログメッセージ |
| データサマリー | 正確 | レコード数確認 |
| エクスポート | 成功 | 新シート確認 |
| クリア | 成功 | シート削除確認 |

**Phase 7 完了**: ✅ / ❌

---

## 📝 Phase 8: E2Eテスト結果レポート

### 8-1. テスト結果サマリー

| Phase | テスト項目 | 結果 | 備考 |
|-------|-----------|------|------|
| Phase 1 | Pythonデータ生成 | ✅ / ❌ |  |
| Phase 2 | Google Driveアップロード | ✅ / ❌ |  |
| Phase 3 | GASコードアップロード | ✅ / ❌ |  |
| Phase 4 | 自動インポート | ✅ / ❌ |  |
| Phase 5 | 個別可視化（5機能） | ✅ / ❌ |  |
| Phase 6 | 統合ダッシュボード | ✅ / ❌ |  |
| Phase 7 | データ管理機能 | ✅ / ❌ |  |

### 8-2. 発見された問題

**問題1**:
- **説明**:
- **重要度**: 高 / 中 / 低
- **再現手順**:
- **期待される動作**:
- **実際の動作**:
- **スクリーンショット**:

**問題2**:
（必要に応じて追加）

### 8-3. パフォーマンス測定結果

| 操作 | 所要時間 | 目標 | 判定 |
|------|---------|------|------|
| Python実行 | ___ 秒 | 60秒以内 | ✅ / ❌ |
| CSVアップロード | ___ 秒 | 30秒以内 | ✅ / ❌ |
| GASインポート | ___ 秒 | 20秒以内 | ✅ / ❌ |
| ダッシュボード初回表示 | ___ 秒 | 15秒以内 | ✅ / ❌ |
| タブ切り替え（2回目） | ___ 秒 | 1秒以内 | ✅ / ❌ |

### 8-4. UI/UX評価

**デザイン**:
- グラデーション背景: ✅ / ❌
- レスポンシブレイアウト: ✅ / ❌
- タブナビゲーション: ✅ / ❌
- 視覚的階層: ✅ / ❌

**ユーザビリティ**:
- メニュー構造: 分かりやすい / 普通 / 分かりにくい
- 操作の直感性: 高 / 中 / 低
- エラーメッセージ: 分かりやすい / 普通 / 分かりにくい

### 8-5. 総合評価

**総合スコア**: ___ / 100点

**評価基準**:
- 90-100点: 本番運用可能
- 70-89点: 軽微な修正が必要
- 50-69点: 重大な修正が必要
- 0-49点: 再実装が必要

**コメント**:


### 8-6. 次のステップ

**即座に修正が必要な項目**:
1.
2.
3.

**将来的な改善提案**:
1.
2.
3.

---

## 🆘 トラブルシューティング

### 問題: 「フォルダが見つかりません」エラー

**原因**: Google Driveに `gas_output_phase7` フォルダがない

**解決方法**:
1. Google Driveでフォルダを手動作成
2. または、GASメニュー: `📁 Phase 7フォルダ作成` を実行

### 問題: 「シートが見つかりません」エラー

**原因**: インポートが未実施またはシートが削除された

**解決方法**:
1. GASメニュー: `🚀 クイックインポート` を実行

### 問題: グラフが表示されない

**原因**: ブラウザキャッシュまたはGoogle Charts読み込みエラー

**解決方法**:
1. ブラウザをリロード（F5）
2. キャッシュクリア（Ctrl+Shift+Delete）
3. 別のブラウザで試す（Chrome推奨）

### 問題: 「権限が必要です」ダイアログ

**原因**: GASスクリプトの初回実行

**解決方法**:
1. 「権限を確認」をクリック
2. Googleアカウントを選択
3. 「許可」をクリック

### 問題: パフォーマンスが遅い

**原因**: 大量のデータまたはブラウザリソース不足

**解決方法**:
1. 小規模データでテスト
2. ブラウザの他のタブを閉じる
3. ブラウザを再起動

---

## 📞 サポート

**問題が解決しない場合**:
1. ブラウザのコンソールログを確認（F12 → Console）
2. Apps ScriptのログをExecution log）
3. スクリーンショットを撮影
4. エラーメッセージを記録

---

## ✅ E2Eテスト完了チェックリスト

- [ ] Phase 1: Pythonデータ生成 ✅
- [ ] Phase 2: Google Driveアップロード ✅
- [ ] Phase 3: GASコードアップロード ✅
- [ ] Phase 4: 自動インポート ✅
- [ ] Phase 5: 個別可視化（5機能） ✅
- [ ] Phase 6: 統合ダッシュボード ✅
- [ ] Phase 7: データ管理機能 ✅
- [ ] Phase 8: テスト結果レポート作成 ✅

**テスト完了日**: ___________
**テスト担当者**: ___________
**総合評価**: _____ / 100点

---

**以上、GAS Phase 7 E2Eテストガイド**
