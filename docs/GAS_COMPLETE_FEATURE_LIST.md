# GASå´å®Œå…¨æ©Ÿèƒ½ä¸€è¦§

**å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ **: Phase 7é«˜åº¦åˆ†ææ©Ÿèƒ½ï¼ˆã‚¸ãƒ§ãƒ–ãƒ¡ãƒ‰ãƒ¬ãƒ¼æ±‚è·è€…ãƒ‡ãƒ¼ã‚¿åˆ†æï¼‰
**æœ€çµ‚æ›´æ–°**: 2025å¹´10æœˆ26æ—¥
**å®Ÿè£…çŠ¶æ³**: 100%å®Œæˆï¼ˆæœ¬ç•ªé‹ç”¨å¯èƒ½ï¼‰

---

## ğŸ“Š ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹æˆ](#ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹æˆ)
3. [ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½](#ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½)
4. [å¯è¦–åŒ–æ©Ÿèƒ½](#å¯è¦–åŒ–æ©Ÿèƒ½)
5. [ãƒ‡ãƒ¼ã‚¿ç®¡ç†æ©Ÿèƒ½](#ãƒ‡ãƒ¼ã‚¿ç®¡ç†æ©Ÿèƒ½)
6. [æŠ€è¡“ä»•æ§˜](#æŠ€è¡“ä»•æ§˜)

---

## ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
Python (run_complete.py)
    â†“ 5ã¤ã®CSVãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ
gas_output_phase7/
â”œâ”€â”€ SupplyDensityMap.csv          # äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—
â”œâ”€â”€ QualificationDistribution.csv # è³‡æ ¼åˆ¥äººæåˆ†å¸ƒ
â”œâ”€â”€ AgeGenderCrossAnalysis.csv    # å¹´é½¢å±¤Ã—æ€§åˆ¥ã‚¯ãƒ­ã‚¹åˆ†æ
â”œâ”€â”€ MobilityScore.csv             # ç§»å‹•è¨±å®¹åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
â””â”€â”€ DetailedPersonaProfile.csv    # ãƒšãƒ«ã‚½ãƒŠè©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
    â†“
3ã¤ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–¹æ³•ï¼ˆé¸æŠå¯èƒ½ï¼‰
â”œâ”€â”€ ğŸ“¤ HTMLã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆæœ€æ¨å¥¨ï¼‰
â”œâ”€â”€ ğŸš€ Google Driveã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
â””â”€â”€ ğŸ“‚ Google Driveæ‰‹å‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
    â†“
Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆï¼ˆ5ã‚·ãƒ¼ãƒˆï¼‰
â”œâ”€â”€ Phase7_SupplyDensity
â”œâ”€â”€ Phase7_QualificationDist
â”œâ”€â”€ Phase7_AgeGenderCross
â”œâ”€â”€ Phase7_MobilityScore
â””â”€â”€ Phase7_PersonaProfile
    â†“
å¯è¦–åŒ–ãƒ¬ã‚¤ãƒ¤ãƒ¼
â”œâ”€â”€ 5ã¤ã®å€‹åˆ¥å¯è¦–åŒ–æ©Ÿèƒ½
â””â”€â”€ 1ã¤ã®çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
```

### å®Ÿè£…è¦æ¨¡

| ã‚«ãƒ†ã‚´ãƒª | ãƒ•ã‚¡ã‚¤ãƒ«æ•° | ç·è¡Œæ•° | èª¬æ˜ |
|---------|-----------|--------|------|
| **ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ** | 2ãƒ•ã‚¡ã‚¤ãƒ« | 650è¡Œ | HTML + GASã‚¹ã‚¯ãƒªãƒ—ãƒˆ |
| **å¯è¦–åŒ–æ©Ÿèƒ½** | 6ãƒ•ã‚¡ã‚¤ãƒ« | 2,200è¡Œ | 5å€‹åˆ¥ + 1çµ±åˆ |
| **ãƒ¡ãƒ‹ãƒ¥ãƒ¼çµ±åˆ** | 1ãƒ•ã‚¡ã‚¤ãƒ« | 250è¡Œ | å®Œå…¨ç‰ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ |
| **HTML UI** | 1ãƒ•ã‚¡ã‚¤ãƒ« | 450è¡Œ | ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒ  |
| **åˆè¨ˆ** | **10ãƒ•ã‚¡ã‚¤ãƒ«** | **3,550è¡Œ** | å®Œå…¨å®Ÿè£… |

---

## ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹æˆ

### å®Œå…¨ç‰ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼éšå±¤

```
ğŸ“Š ãƒ‡ãƒ¼ã‚¿å‡¦ç†
  â””â”€â”€ ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ
      â”‚
      â”œâ”€â”€ ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
      â”‚   â”œâ”€â”€ ğŸ“¤ HTMLã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆæœ€ã‚‚ç°¡å˜ï¼‰         â† NEW!
      â”‚   â”œâ”€â”€ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      â”‚   â”œâ”€â”€ ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆGoogle Driveï¼‰
      â”‚   â”œâ”€â”€ ğŸ“‚ Google Driveã‹ã‚‰è‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
      â”‚   â”œâ”€â”€ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      â”‚   â”œâ”€â”€ ğŸ“ Phase 7ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ
      â”‚   â”œâ”€â”€ â„¹ï¸ Google Driveãƒ•ã‚©ãƒ«ãƒ€æƒ…å ±
      â”‚   â”œâ”€â”€ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      â”‚   â””â”€â”€ âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ³ç¢ºèª                 â† NEW!
      â”‚
      â”œâ”€â”€ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      â”‚
      â”œâ”€â”€ ğŸ“Š å€‹åˆ¥åˆ†æ
      â”‚   â”œâ”€â”€ ğŸ—ºï¸ äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—
      â”‚   â”œâ”€â”€ ğŸ“ è³‡æ ¼åˆ¥äººæåˆ†å¸ƒ
      â”‚   â”œâ”€â”€ ğŸ‘¥ å¹´é½¢å±¤Ã—æ€§åˆ¥ã‚¯ãƒ­ã‚¹åˆ†æ
      â”‚   â”œâ”€â”€ ğŸš— ç§»å‹•è¨±å®¹åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
      â”‚   â””â”€â”€ ğŸ“Š ãƒšãƒ«ã‚½ãƒŠè©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
      â”‚
      â”œâ”€â”€ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      â”‚
      â”œâ”€â”€ ğŸ¯ å®Œå…¨çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
      â”‚
      â”œâ”€â”€ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      â”‚
      â”œâ”€â”€ ğŸ”§ ãƒ‡ãƒ¼ã‚¿ç®¡ç†
      â”‚   â”œâ”€â”€ âœ… ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
      â”‚   â”œâ”€â”€ ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼
      â”‚   â”œâ”€â”€ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      â”‚   â”œâ”€â”€ ğŸ“¤ ãƒ©ãƒ³ã‚¯åˆ¥å†…è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
      â”‚   â”œâ”€â”€ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      â”‚   â””â”€â”€ ğŸ§¹ å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢
      â”‚
      â”œâ”€â”€ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
      â”‚
      â””â”€â”€ â“ Phase 7ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ
```

---

## ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½

### æ–¹æ³•1: ğŸ“¤ HTMLã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆæœ€æ¨å¥¨ï¼‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Phase7Upload.html` + `Phase7HTMLUploader.gs`

#### ç‰¹å¾´

- âœ… **æœ€ã‚‚ç°¡å˜**: ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ç›´æ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- âœ… **Google Driveä¸è¦**: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç›´æ¥
- âœ… **ç¾ã—ã„UI**: ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ã€ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œ
- âœ… **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: é€²è¡ŒçŠ¶æ³ã‚’è¦–è¦šåŒ–

#### UIæ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ - ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚ ğŸ“‹ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ‰‹é †                                   â”‚
â”‚ 1. Python ã§ run_complete.py ã‚’å®Ÿè¡Œ                  â”‚
â”‚ 2. gas_output_phase7 ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰5ã¤ã®CSVã‚’é¸æŠ       â”‚
â”‚ 3. ã€Œã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯                      â”‚
â”‚                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚  ğŸ—ºï¸        ğŸ“        ğŸ‘¥        ğŸš—        ğŸ“Š         â”‚
â”‚ äººæä¾›çµ¦   è³‡æ ¼åˆ¥   å¹´é½¢Ã—æ€§åˆ¥  ç§»å‹•è¨±å®¹  ãƒšãƒ«ã‚½ãƒŠ     â”‚
â”‚ å¯†åº¦ãƒãƒƒãƒ— äººæåˆ†å¸ƒ  ã‚¯ãƒ­ã‚¹åˆ†æ ã‚¹ã‚³ã‚¢    ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« â”‚
â”‚                                                       â”‚
â”‚ [ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ] [ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ] [ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ]     â”‚
â”‚                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ é¸æŠæ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«: 5 / 5                               â”‚
â”‚ åˆè¨ˆã‚µã‚¤ã‚º: 320.5 KB                                 â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 100% â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚
â”‚                                                       â”‚
â”‚        [ğŸš€ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–‹å§‹]  [ğŸ”„ ã‚¯ãƒªã‚¢]             â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¸»è¦é–¢æ•°

| é–¢æ•°å | å½¹å‰² | æˆ»ã‚Šå€¤ |
|--------|------|--------|
| `showPhase7UploadDialog()` | ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰UIã‚’è¡¨ç¤º | - |
| `importPhase7CSV(sheetName, csvData)` | CSVã‚’ã‚·ãƒ¼ãƒˆã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ | `{success, sheetName, rows, columns}` |
| `validatePhase7Upload()` | ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ³ã‚’æ¤œè¨¼ | `{allValid, sheets[]}` |
| `showPhase7UploadSummary()` | ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ³ã‚’è¡¨ç¤º | - |

#### å‡¦ç†ãƒ•ãƒ­ãƒ¼

```javascript
// 1. ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
handleFile('supply') â†’ files.supply.file = File

// 2. CSVãƒ‘ãƒ¼ã‚¹
readFileAsText(file) â†’ parseCSV(text) â†’ Array<Array<string>>

// 3. GASã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
google.script.run.importPhase7CSV(sheetName, csvData)

// 4. ã‚·ãƒ¼ãƒˆä½œæˆãƒ»æ›´æ–°
SpreadsheetApp.getActiveSpreadsheet().insertSheet(sheetName)
sheet.getRange(1, 1, numRows, numCols).setValues(csvData)
```

#### ãƒ‡ã‚¶ã‚¤ãƒ³ä»•æ§˜

```css
/* ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ */
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);

/* ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³ */
.file-drop {
  border: 2px dashed #ccc;
  transition: all 0.3s;
}

.file-drop:hover {
  border-color: #667eea;
  background: #f5f5ff;
}

.file-drop.uploaded {
  border-color: #34A853;
  background: #e6f4ea;
}

/* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */
.progress-bar {
  background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
}
```

---

### æ–¹æ³•2: ğŸš€ Google Driveã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Phase7AutoImporter.gs`

#### ç‰¹å¾´

- âœ… **ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯**: ãƒ•ã‚©ãƒ«ãƒ€æ¤œç´¢ â†’ ã‚¤ãƒ³ãƒãƒ¼ãƒˆè‡ªå‹•åŒ–
- âœ… **BOMé™¤å»**: UTF-8 BOMè‡ªå‹•é™¤å»
- âœ… **è‡ªå‹•æ¤œè¨¼**: ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¾Œã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
- âœ… **ä¸€æ‹¬å‡¦ç†**: 5ãƒ•ã‚¡ã‚¤ãƒ«åŒæ™‚ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

#### ä¸»è¦é–¢æ•°

| é–¢æ•°å | å½¹å‰² | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ |
|--------|------|----------|
| `quickImportLatestPhase7Data()` | ã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ | - |
| `autoImportPhase7Data()` | è‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆGoogle Driveï¼‰ | - |
| `findFolderByName(folderName)` | ãƒ•ã‚©ãƒ«ãƒ€æ¤œç´¢ | `string` |
| `importCSVFileToSheet(file, sheetName)` | CSV â†’ ã‚·ãƒ¼ãƒˆå¤‰æ› | `File, string` |
| `importCSVDataToSheet(data, sheetName)` | ãƒ‡ãƒ¼ã‚¿é…åˆ— â†’ ã‚·ãƒ¼ãƒˆæ›¸ãè¾¼ã¿ | `Array[][], string` |

#### å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
1. Google Driveãƒ•ã‚©ãƒ«ãƒ€æ¤œç´¢
   DriveApp.getFoldersByName('gas_output_phase7')

2. 5ã¤ã®CSVãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢
   folder.getFilesByName('SupplyDensityMap.csv')
   folder.getFilesByName('QualificationDistribution.csv')
   folder.getFilesByName('AgeGenderCrossAnalysis.csv')
   folder.getFilesByName('MobilityScore.csv')
   folder.getFilesByName('DetailedPersonaProfile.csv')

3. CSVè§£æ
   file.getBlob().getDataAsString('UTF-8')
   cleanedContent = content.replace(/^\uFEFF/, '') // BOMé™¤å»
   data = Utilities.parseCsv(cleanedContent)

4. ã‚·ãƒ¼ãƒˆä½œæˆãƒ»æ›´æ–°
   sheet.clear() // æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢
   sheet.getRange(1, 1, rows, cols).setValues(data)

5. ãƒ˜ãƒƒãƒ€ãƒ¼æ›¸å¼è¨­å®š
   headerRange.setBackground('#1a73e8')
              .setFontColor('white')
              .setFontWeight('bold')

6. æ¤œè¨¼
   validatePhase7Data() â†’ æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
```

#### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```javascript
try {
  const folder = findFolderByName('gas_output_phase7');

  if (!folder) {
    ui.alert('ã‚¨ãƒ©ãƒ¼',
      'Google Driveã«ã€Œgas_output_phase7ã€ãƒ•ã‚©ãƒ«ãƒ€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚\n\n' +
      'è§£æ±ºæ–¹æ³•:\n' +
      '1. ãƒ¡ãƒ‹ãƒ¥ãƒ¼ > ğŸ“ Phase 7ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ ã‚’å®Ÿè¡Œ\n' +
      '2. Pythonã§CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ\n' +
      '3. ä½œæˆã•ã‚ŒãŸãƒ•ã‚©ãƒ«ãƒ€ã«CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',
      ui.ButtonSet.OK
    );
    return;
  }

  // ã‚¤ãƒ³ãƒãƒ¼ãƒˆå‡¦ç†...

} catch (error) {
  ui.alert('ã‚¨ãƒ©ãƒ¼', `ã‚¤ãƒ³ãƒãƒ¼ãƒˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:\n${error.message}`, ui.ButtonSet.OK);
  Logger.log(`ã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼: ${error.stack}`);
}
```

---

### æ–¹æ³•3: ğŸ“‚ Google Driveæ‰‹å‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

**è£œåŠ©æ©Ÿèƒ½**:

| æ©Ÿèƒ½ | é–¢æ•°å | èª¬æ˜ |
|------|--------|------|
| ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ | `createPhase7FolderInDrive()` | Google Driveã«`gas_output_phase7`ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ |
| ãƒ•ã‚©ãƒ«ãƒ€æƒ…å ± | `showGoogleDriveFolderInfo()` | ãƒ•ã‚©ãƒ«ãƒ€ã®URLã€ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§è¡¨ç¤º |

---

## å¯è¦–åŒ–æ©Ÿèƒ½

### å€‹åˆ¥å¯è¦–åŒ–æ©Ÿèƒ½ï¼ˆ5ã¤ï¼‰

#### 1. ğŸ—ºï¸ äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Phase7SupplyDensityViz.gs` (350è¡Œ)

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: `Phase7_SupplyDensity` ã‚·ãƒ¼ãƒˆ

**è¡¨ç¤ºå†…å®¹**:

| å¯è¦–åŒ– | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|--------|--------|------|
| ãƒãƒ–ãƒ«ãƒãƒ£ãƒ¼ãƒˆ | Google Charts | ãƒ©ãƒ³ã‚¯åˆ¥è‰²åˆ†ã‘ï¼ˆé‡‘Sã€é’Aã€ç·‘Bã€æ©™Cã€ç°Dï¼‰ |
| ãƒ©ãƒ³ã‚¯åˆ¥å††ã‚°ãƒ©ãƒ• | Google Charts | åœ°åŸŸæ•°åˆ†å¸ƒ |
| çµ±è¨ˆã‚µãƒãƒªãƒ¼ | HTML | ç·åœ°åŸŸæ•°ã€å¹³å‡ã‚¹ã‚³ã‚¢ã€ãƒ©ãƒ³ã‚¯åˆ†å¸ƒ |
| è©³ç´°ãƒ†ãƒ¼ãƒ–ãƒ« | HTML | å…¨åœ°åŸŸãƒ‡ãƒ¼ã‚¿ |

**ä¸»è¦é–¢æ•°**:

```javascript
showSupplyDensityMap()              // ãƒ¡ã‚¤ãƒ³è¡¨ç¤ºé–¢æ•°
loadSupplyDensityData()             // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
generateSupplyDensityHTML(data)     // HTMLç”Ÿæˆ
calculateSupplyDensityStats(data)   // çµ±è¨ˆè¨ˆç®—
```

**ãƒãƒ–ãƒ«ãƒãƒ£ãƒ¼ãƒˆä»•æ§˜**:

```javascript
{
  cols: [
    { label: 'ID', type: 'string' },
    { label: 'ç·æ±‚è·è€…æ•°', type: 'number' },
    { label: 'ç·åˆã‚¹ã‚³ã‚¢', type: 'number' },
    { label: 'ãƒ©ãƒ³ã‚¯', type: 'string' },
    { label: 'ãƒãƒ–ãƒ«ã‚µã‚¤ã‚º', type: 'number' }
  ],
  rows: [
    { c: [
      { v: "äº¬éƒ½åºœ" },
      { v: 6159 },
      { v: 2484.58 },
      { v: "S" },
      { v: 6159 }
    ]},
    // ...
  ]
}
```

**è‰²åˆ†ã‘ãƒ­ã‚¸ãƒƒã‚¯**:

```javascript
const colorMap = {
  'S': '#FFD700',  // é‡‘è‰²ï¼ˆè¶…å„ªè‰¯ï¼‰
  'A': '#4285F4',  // é’ï¼ˆå„ªè‰¯ï¼‰
  'B': '#34A853',  // ç·‘ï¼ˆæ¨™æº–ï¼‰
  'C': '#FBBC04',  // æ©™ï¼ˆæ³¨æ„ï¼‰
  'D': '#9E9E9E'   // ç°ï¼ˆè¦æ”¹å–„ï¼‰
};
```

---

#### 2. ğŸ“ è³‡æ ¼åˆ¥äººæåˆ†å¸ƒ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Phase7QualificationDistViz.gs` (200è¡Œ)

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: `Phase7_QualificationDist` ã‚·ãƒ¼ãƒˆ

**è¡¨ç¤ºå†…å®¹**:

| å¯è¦–åŒ– | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|--------|--------|------|
| çµ±è¨ˆã‚µãƒãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ | HTML | è³‡æ ¼ã‚«ãƒ†ã‚´ãƒªæ•°ã€ç·ä¿æœ‰è€…æ•°ã€å¹³å‡ä¿æœ‰è€…æ•° |
| æ¨ªæ£’ã‚°ãƒ©ãƒ• | Google Charts | ä¿æœ‰è€…æ•°é™é † |
| è©³ç´°ãƒ†ãƒ¼ãƒ–ãƒ« | HTML | å¸Œå°‘åœ°åŸŸãƒãƒƒã‚¸ä»˜ã |

**ä¸»è¦é–¢æ•°**:

```javascript
showQualificationDistribution()              // ãƒ¡ã‚¤ãƒ³è¡¨ç¤ºé–¢æ•°
loadQualificationDistData()                  // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
generateQualificationDistHTML(data)          // HTMLç”Ÿæˆ
```

**çµ±è¨ˆã‚µãƒãƒªãƒ¼ã‚«ãƒ¼ãƒ‰**:

```javascript
const stats = [
  {label: 'è³‡æ ¼ã‚«ãƒ†ã‚´ãƒªæ•°', value: totalCategories, unit: 'ç¨®é¡'},
  {label: 'ç·ä¿æœ‰è€…æ•°', value: totalHolders.toLocaleString(), unit: 'å'},
  {label: 'å¹³å‡ä¿æœ‰è€…æ•°', value: Math.round(avgHolders).toLocaleString(), unit: 'å'}
];
```

**å¸Œå°‘åœ°åŸŸãƒãƒƒã‚¸**:

```javascript
const rareRegionsHtml = row.rareRegions
  ? `${row.rareRegions} <span class="rare-badge">è¦æ³¨ç›®</span>`
  : 'ï¼';
```

---

#### 3. ğŸ‘¥ å¹´é½¢å±¤Ã—æ€§åˆ¥ã‚¯ãƒ­ã‚¹åˆ†æ

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Phase7AgeGenderCrossViz.gs` (300è¡Œ)

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: `Phase7_AgeGenderCross` ã‚·ãƒ¼ãƒˆ

**è¡¨ç¤ºå†…å®¹**:

| å¯è¦–åŒ– | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|--------|--------|------|
| ç©ã¿ä¸Šã’æ£’ã‚°ãƒ©ãƒ• | Google Charts | åœ°åŸŸåˆ¥æ§‹æˆæ¯”ï¼ˆè‹¥å¹´å¥³æ€§/ä¸­å¹´å¥³æ€§/ãã®ä»–ï¼‰ |
| æ”¯é…çš„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆå††ã‚°ãƒ©ãƒ• | Google Charts | ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†å¸ƒ |
| ãƒ€ã‚¤ãƒãƒ¼ã‚·ãƒ†ã‚£ã‚¹ã‚³ã‚¢ãƒãƒ£ãƒ¼ãƒˆ | Google Charts | ã‚¹ã‚³ã‚¢é™é † |
| ã‚¹ã‚³ã‚¢åˆ¥èƒŒæ™¯è‰²ãƒ†ãƒ¼ãƒ–ãƒ« | HTML | é«˜=ç·‘ã€ä¸­=é»„ã€ä½=èµ¤ |

**ä¸»è¦é–¢æ•°**:

```javascript
showAgeGenderCrossAnalysis()              // ãƒ¡ã‚¤ãƒ³è¡¨ç¤ºé–¢æ•°
loadAgeGenderCrossData()                  // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
generateAgeGenderCrossHTML(data)          // HTMLç”Ÿæˆ
calculateAgeGenderStats(data)             // çµ±è¨ˆè¨ˆç®—
```

**ç©ã¿ä¸Šã’æ£’ã‚°ãƒ©ãƒ•ä»•æ§˜**:

```javascript
const options = {
  title: 'åœ°åŸŸåˆ¥äººææ§‹æˆï¼ˆTOP10ï¼‰',
  isStacked: 'percent',  // ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆè¡¨ç¤º
  hAxis: {title: 'æ§‹æˆæ¯”ï¼ˆ%ï¼‰'},
  vAxis: {title: 'å¸‚åŒºç”ºæ‘'},
  colors: ['#4285F4', '#34A853', '#FBBC04'],  // è‹¥å¹´å¥³æ€§/ä¸­å¹´å¥³æ€§/ãã®ä»–
  chartArea: {width: '60%'}
};
```

**ãƒ€ã‚¤ãƒãƒ¼ã‚·ãƒ†ã‚£ã‚¹ã‚³ã‚¢èƒŒæ™¯è‰²**:

```css
.diversity-high { background-color: #d4edda; }   /* ã‚¹ã‚³ã‚¢ â‰¥ 0.7 */
.diversity-medium { background-color: #fff3cd; } /* 0.5 â‰¤ ã‚¹ã‚³ã‚¢ < 0.7 */
.diversity-low { background-color: #f8d7da; }    /* ã‚¹ã‚³ã‚¢ < 0.5 */
```

---

#### 4. ğŸš— ç§»å‹•è¨±å®¹åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Phase7MobilityScoreViz.gs` (400è¡Œ)

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: `Phase7_MobilityScore` ã‚·ãƒ¼ãƒˆ

**è¡¨ç¤ºå†…å®¹**:

| å¯è¦–åŒ– | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|--------|--------|------|
| ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ  | Google Charts | ã‚¹ã‚³ã‚¢åˆ†å¸ƒï¼ˆ5åŒºé–“ï¼‰ |
| ãƒ¬ãƒ™ãƒ«åˆ¥å††ã‚°ãƒ©ãƒ• | Google Charts | A/B/C/Dåˆ†å¸ƒ |
| æ•£å¸ƒå›³ | Google Charts | å¸Œæœ›åœ°æ•° Ã— æœ€å¤§è·é›¢ |
| å±…ä½åœ°åˆ¥TOP10ãƒ†ãƒ¼ãƒ–ãƒ« | HTML | å¹³å‡ã‚¹ã‚³ã‚¢ä»˜ã |

**ä¸»è¦é–¢æ•°**:

```javascript
showMobilityScoreAnalysis()              // ãƒ¡ã‚¤ãƒ³è¡¨ç¤ºé–¢æ•°
loadMobilityScoreData()                  // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
generateMobilityScoreHTML(data)          // HTMLç”Ÿæˆ
calculateMobilityStats(data)             // çµ±è¨ˆè¨ˆç®—
```

**ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ åŒºé–“**:

```javascript
const bins = [
  {label: '0.0-0.2', min: 0.0, max: 0.2},  // æ¥µä½
  {label: '0.2-0.4', min: 0.2, max: 0.4},  // ä½
  {label: '0.4-0.6', min: 0.4, max: 0.6},  // ä¸­
  {label: '0.6-0.8', min: 0.6, max: 0.8},  // é«˜
  {label: '0.8-1.0', min: 0.8, max: 1.0}   // æ¥µé«˜
];
```

**ç§»å‹•è¨±å®¹åº¦ãƒ¬ãƒ™ãƒ«**:

```javascript
const levelMap = {
  'A': 'é«˜ï¼ˆã‚¹ã‚³ã‚¢ â‰¥ 0.6ï¼‰',
  'B': 'ä¸­ï¼ˆ0.4 â‰¤ ã‚¹ã‚³ã‚¢ < 0.6ï¼‰',
  'C': 'ä½ï¼ˆ0.2 â‰¤ ã‚¹ã‚³ã‚¢ < 0.4ï¼‰',
  'D': 'æ¥µä½ï¼ˆã‚¹ã‚³ã‚¢ < 0.2ï¼‰'
};
```

---

#### 5. ğŸ“Š ãƒšãƒ«ã‚½ãƒŠè©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Phase7PersonaProfileViz.gs` (450è¡Œ)

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: `Phase7_PersonaProfile` ã‚·ãƒ¼ãƒˆ

**è¡¨ç¤ºå†…å®¹**:

| å¯è¦–åŒ– | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|--------|--------|------|
| ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ | Google Charts | 6è»¸æ¯”è¼ƒï¼ˆå¹³å‡å¹´é½¢/å¥³æ€§æ¯”ç‡/è³‡æ ¼ä¿æœ‰ç‡/å¹³å‡è³‡æ ¼æ•°/å¹³å‡å¸Œæœ›åœ°æ•°/ç·Šæ€¥åº¦ï¼‰ |
| ãƒšãƒ«ã‚½ãƒŠã‚«ãƒ¼ãƒ‰ | HTML | 5è‰²ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ |
| æ§‹æˆæ¯”å††ã‚°ãƒ©ãƒ• | Google Charts | äººæ•°åˆ†å¸ƒ |
| æ¯”è¼ƒãƒ†ãƒ¼ãƒ–ãƒ« | HTML | å…¨ãƒšãƒ«ã‚½ãƒŠæ¯”è¼ƒ |

**ä¸»è¦é–¢æ•°**:

```javascript
showDetailedPersonaProfile()              // ãƒ¡ã‚¤ãƒ³è¡¨ç¤ºé–¢æ•°
loadPersonaProfileData()                  // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
generatePersonaProfileHTML(data)          // HTMLç”Ÿæˆ
```

**ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ6è»¸**:

```javascript
const metrics = [
  {name: 'å¹³å‡å¹´é½¢', getValue: p => p.avgAge / 100},       // æ­£è¦åŒ–ï¼ˆ0-1ï¼‰
  {name: 'å¥³æ€§æ¯”ç‡', getValue: p => p.femaleRatio},        // 0-1
  {name: 'è³‡æ ¼ä¿æœ‰ç‡', getValue: p => p.qualifiedRate},    // 0-1
  {name: 'å¹³å‡è³‡æ ¼æ•°', getValue: p => p.avgQualifications / 5},  // æ­£è¦åŒ–
  {name: 'å¹³å‡å¸Œæœ›åœ°æ•°', getValue: p => p.avgDesiredLocs / 5},   // æ­£è¦åŒ–
  {name: 'ç·Šæ€¥åº¦', getValue: p => p.urgency}                // 0-1
];
```

**ãƒšãƒ«ã‚½ãƒŠã‚«ãƒ¼ãƒ‰é…è‰²**:

```css
.persona-card.card-0 { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
.persona-card.card-1 { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
.persona-card.card-2 { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
.persona-card.card-3 { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
.persona-card.card-4 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
```

---

### çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

**ãƒ•ã‚¡ã‚¤ãƒ«**: `Phase7CompleteDashboard.gs` (500è¡Œ)

**ç›®çš„**: 5ã¤ã®åˆ†æã‚’1ã¤ã®UIã§çµ±åˆè¡¨ç¤º

#### ã‚¿ãƒ–æ§‹æˆ

```
å®Œå…¨çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”œâ”€â”€ Tab 1: ğŸ“‹ æ¦‚è¦ï¼ˆKPIè¡¨ç¤ºï¼‰
â”œâ”€â”€ Tab 2: ğŸ—ºï¸ äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—
â”œâ”€â”€ Tab 3: ğŸ“ è³‡æ ¼åˆ¥äººæåˆ†å¸ƒ
â”œâ”€â”€ Tab 4: ğŸ‘¥ å¹´é½¢å±¤Ã—æ€§åˆ¥ã‚¯ãƒ­ã‚¹åˆ†æ
â”œâ”€â”€ Tab 5: ğŸš— ç§»å‹•è¨±å®¹åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
â””â”€â”€ Tab 6: ğŸ“Š ãƒšãƒ«ã‚½ãƒŠè©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
```

#### ä¸»è¦æ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| **ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ** | JavaScriptã§ã‚¹ãƒ ãƒ¼ã‚ºãªåˆ‡ã‚Šæ›¿ãˆ |
| **é…å»¶ãƒ­ãƒ¼ãƒ‰** | åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã®ã¿ã‚°ãƒ©ãƒ•æç”»ï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ï¼‰ |
| **KPIã‚«ãƒ¼ãƒ‰** | æ¦‚è¦ã‚¿ãƒ–ã§5ã¤ã®KPIã‚’è¡¨ç¤º |
| **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–** | ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§æŸ”è»Ÿã«å¯¾å¿œ |

#### KPIã‚«ãƒ¼ãƒ‰ï¼ˆæ¦‚è¦ã‚¿ãƒ–ï¼‰

```javascript
const kpis = [
  {
    icon: 'ğŸ‘¥',
    label: 'ç·æ±‚è·è€…æ•°',
    value: calculateTotalJobseekers().toLocaleString(),
    unit: 'å',
    color: '#667eea'
  },
  {
    icon: 'ğŸ—ºï¸',
    label: 'åˆ†æå¯¾è±¡åœ°åŸŸæ•°',
    value: calculateTotalMunicipalities(),
    unit: 'åœ°åŸŸ',
    color: '#4facfe'
  },
  {
    icon: 'ğŸ“',
    label: 'è³‡æ ¼ã‚«ãƒ†ã‚´ãƒªæ•°',
    value: calculateTotalQualifications(),
    unit: 'ç¨®é¡',
    color: '#43e97b'
  },
  {
    icon: 'ğŸš—',
    label: 'å¹³å‡ç§»å‹•è¨±å®¹åº¦',
    value: calculateAvgMobilityScore().toFixed(2),
    unit: 'ã‚¹ã‚³ã‚¢',
    color: '#fa709a'
  },
  {
    icon: 'ğŸ“Š',
    label: 'ãƒšãƒ«ã‚½ãƒŠã‚»ã‚°ãƒ¡ãƒ³ãƒˆæ•°',
    value: calculateTotalPersonas(),
    unit: 'ç¨®é¡',
    color: '#f093fb'
  }
];
```

#### ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆãƒ­ã‚¸ãƒƒã‚¯

```javascript
function switchTab(tabName) {
  // ã™ã¹ã¦ã®ã‚¿ãƒ–ã‚’éè¡¨ç¤º
  document.querySelectorAll('.tab-content').forEach(tab => {
    tab.style.display = 'none';
  });

  // ã™ã¹ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‚’éã‚¢ã‚¯ãƒ†ã‚£ãƒ–
  document.querySelectorAll('.tab-button').forEach(btn => {
    btn.classList.remove('active');
  });

  // é¸æŠã•ã‚ŒãŸã‚¿ãƒ–ã‚’è¡¨ç¤º
  document.getElementById(tabName).style.display = 'block';

  // é¸æŠã•ã‚ŒãŸãƒœã‚¿ãƒ³ã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–
  document.querySelector(`[onclick="switchTab('${tabName}')"]`).classList.add('active');

  // é…å»¶ãƒ­ãƒ¼ãƒ‰ï¼ˆåˆå›ã®ã¿ï¼‰
  if (tabName === 'supply-density' && !window.supplyDensityLoaded) {
    drawSupplyDensityCharts();
    window.supplyDensityLoaded = true;
  }
  // ... ä»–ã®ã‚¿ãƒ–ã‚‚åŒæ§˜
}
```

#### UIãƒ‡ã‚¶ã‚¤ãƒ³

```css
/* ã‚¿ãƒ–ãƒœã‚¿ãƒ³ */
.tab-button {
  padding: 12px 24px;
  border: none;
  background: none;
  cursor: pointer;
  transition: all 0.3s;
}

.tab-button.active {
  color: #1a73e8;
  border-bottom: 3px solid #1a73e8;
  font-weight: bold;
}

/* ã‚³ãƒ³ãƒ†ãƒŠ */
.container {
  background-color: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯ */
body {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
```

---

## ãƒ‡ãƒ¼ã‚¿ç®¡ç†æ©Ÿèƒ½

### 1. âœ… ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼

**é–¢æ•°**: `validatePhase7Data()`

**æ©Ÿèƒ½**: 5ã¤ã®ã‚·ãƒ¼ãƒˆã®å­˜åœ¨ã¨æ•´åˆæ€§ã‚’ç¢ºèª

**æ¤œè¨¼é …ç›®**:

```javascript
const expectedSheets = [
  { name: 'Phase7_SupplyDensity', minRows: 10, minCols: 7 },
  { name: 'Phase7_QualificationDist', minRows: 5, minCols: 4 },
  { name: 'Phase7_AgeGenderCross', minRows: 10, minCols: 6 },
  { name: 'Phase7_MobilityScore', minRows: 100, minCols: 7 },
  { name: 'Phase7_PersonaProfile', minRows: 3, minCols: 12 }
];
```

**å‡ºåŠ›ä¾‹**:

```
Phase 7ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼çµæœ

âœ… Phase7_SupplyDensity: 42è¡Œã€7ã‚«ãƒ©ãƒ 
âœ… Phase7_QualificationDist: 15è¡Œã€4ã‚«ãƒ©ãƒ 
âœ… Phase7_AgeGenderCross: 42è¡Œã€6ã‚«ãƒ©ãƒ 
âœ… Phase7_MobilityScore: 7390è¡Œã€7ã‚«ãƒ©ãƒ 
âœ… Phase7_PersonaProfile: 10è¡Œã€12ã‚«ãƒ©ãƒ 

ã™ã¹ã¦ã®ã‚·ãƒ¼ãƒˆãŒæ­£å¸¸ã§ã™ã€‚
```

---

### 2. ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼

**é–¢æ•°**: `showPhase7DataSummary()`

**æ©Ÿèƒ½**: å„ã‚·ãƒ¼ãƒˆã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ã‚’è¡¨ç¤º

**å‡ºåŠ›ä¾‹**:

```
Phase 7ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼

Phase7_SupplyDensity: 42ãƒ¬ã‚³ãƒ¼ãƒ‰
Phase7_QualificationDist: 15ãƒ¬ã‚³ãƒ¼ãƒ‰
Phase7_AgeGenderCross: 42ãƒ¬ã‚³ãƒ¼ãƒ‰
Phase7_MobilityScore: 7390ãƒ¬ã‚³ãƒ¼ãƒ‰
Phase7_PersonaProfile: 10ãƒ¬ã‚³ãƒ¼ãƒ‰

åˆè¨ˆ: 7499ãƒ¬ã‚³ãƒ¼ãƒ‰
```

---

### 3. ğŸ“¤ ãƒ©ãƒ³ã‚¯åˆ¥å†…è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

**é–¢æ•°**: `exportRankBreakdownToSheet()`

**æ©Ÿèƒ½**: äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—ã®è©³ç´°ã‚’ã‚·ãƒ¼ãƒˆå‡ºåŠ›

**å‡ºåŠ›ã‚·ãƒ¼ãƒˆ**: `Phase7_RankBreakdown`

**ã‚«ãƒ©ãƒ æ§‹æˆ**:

```
å¸‚åŒºç”ºæ‘ | ãƒ©ãƒ³ã‚¯ | æ±‚è·è€…æ•° | è³‡æ ¼ä¿æœ‰ç‡ | å¹³å‡å¹´é½¢ | ç·åˆã‚¹ã‚³ã‚¢
```

---

### 4. ğŸ§¹ å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢

**é–¢æ•°**: `clearAllPhase7Data()`

**æ©Ÿèƒ½**: Phase 7ã®å…¨ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰

**å‰Šé™¤å¯¾è±¡**:

```javascript
const sheetsToDelete = [
  'Phase7_SupplyDensity',
  'Phase7_QualificationDist',
  'Phase7_AgeGenderCross',
  'Phase7_MobilityScore',
  'Phase7_PersonaProfile',
  'Phase7_RankBreakdown'  // ãƒ©ãƒ³ã‚¯åˆ¥å†…è¨³ã‚·ãƒ¼ãƒˆï¼ˆã‚ã‚Œã°ï¼‰
];
```

**ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°**:

```javascript
const response = ui.alert(
  'ç¢ºèª',
  'Phase 7ã®ã™ã¹ã¦ã®ã‚·ãƒ¼ãƒˆï¼ˆ5-6ã‚·ãƒ¼ãƒˆï¼‰ã‚’å‰Šé™¤ã—ã¾ã™ã€‚\n' +
  'ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚\n\n' +
  'æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ',
  ui.ButtonSet.YES_NO
);

if (response === ui.Button.YES) {
  // å‰Šé™¤å‡¦ç†...
}
```

---

## æŠ€è¡“ä»•æ§˜

### ä½¿ç”¨æŠ€è¡“

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | èª¬æ˜ |
|---------|------|------|
| **è¨€èª** | Google Apps Script (JavaScript) | GASç’°å¢ƒ |
| **UI** | HTML + CSS + JavaScript | HtmlService |
| **ã‚°ãƒ©ãƒ•** | Google Charts API | å¯è¦–åŒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª |
| **ãƒ‡ãƒ¼ã‚¿** | Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ | ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ |
| **ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸** | Google Drive API | ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç† |

### APIãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

#### SpreadsheetApp

```javascript
// ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆå–å¾—
const ss = SpreadsheetApp.getActiveSpreadsheet();

// ã‚·ãƒ¼ãƒˆå–å¾—
const sheet = ss.getSheetByName('Phase7_SupplyDensity');

// ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
const range = sheet.getRange(2, 1, lastRow - 1, 7);
const values = range.getValues();

// ãƒ‡ãƒ¼ã‚¿æ›¸ãè¾¼ã¿
sheet.getRange(1, 1, numRows, numCols).setValues(csvData);

// æ›¸å¼è¨­å®š
headerRange.setBackground('#1a73e8')
           .setFontColor('white')
           .setFontWeight('bold');
```

#### DriveApp

```javascript
// ãƒ•ã‚©ãƒ«ãƒ€æ¤œç´¢
const folders = DriveApp.getFoldersByName('gas_output_phase7');

// ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢
const files = folder.getFilesByName('SupplyDensityMap.csv');

// ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
const content = file.getBlob().getDataAsString('UTF-8');
```

#### Utilities

```javascript
// CSVãƒ‘ãƒ¼ã‚¹
const data = Utilities.parseCsv(cleanedContent);
```

#### HtmlService

```javascript
// HTMLãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º
const html = HtmlService.createHtmlOutput(htmlContent)
  .setWidth(1400)
  .setHeight(900);

SpreadsheetApp.getUi().showModalDialog(html, 'ã‚¿ã‚¤ãƒˆãƒ«');

// HTMLãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã¿
const html = HtmlService.createHtmlOutputFromFile('Phase7Upload');
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

#### 1. é…å»¶ãƒ­ãƒ¼ãƒ‰

```javascript
// åˆå›ã‚¢ã‚¯ã‚»ã‚¹æ™‚ã®ã¿ã‚°ãƒ©ãƒ•æç”»
if (!window.supplyDensityLoaded) {
  drawSupplyDensityCharts();
  window.supplyDensityLoaded = true;
}
```

#### 2. ãƒãƒƒãƒå‡¦ç†

```javascript
// 1è¡Œãšã¤æ›¸ãè¾¼ã¿ï¼ˆé…ã„ï¼‰
for (let i = 0; i < data.length; i++) {
  sheet.getRange(i + 1, 1, 1, data[i].length).setValues([data[i]]);
}

// ä¸€æ‹¬æ›¸ãè¾¼ã¿ï¼ˆé€Ÿã„ï¼‰
sheet.getRange(1, 1, data.length, data[0].length).setValues(data);
```

#### 3. ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨

```javascript
// ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥
const chartDataCache = {};

function getChartData(type) {
  if (!chartDataCache[type]) {
    chartDataCache[type] = generateChartData(type);
  }
  return chartDataCache[type];
}
```

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```javascript
try {
  // å‡¦ç†...
} catch (error) {
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
  ui.alert('ã‚¨ãƒ©ãƒ¼',
    `å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:\n${error.message}\n\n` +
    'è§£æ±ºæ–¹æ³•:\n' +
    '1. ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª\n' +
    '2. ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ï¼ˆF5ï¼‰\n' +
    '3. ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚’å®Ÿè¡Œ',
    ui.ButtonSet.OK
  );

  // ãƒ­ã‚°è¨˜éŒ²
  Logger.log(`ã‚¨ãƒ©ãƒ¼: ${error.stack}`);
}
```

---

## ğŸ“Š å®Ÿè£…å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

- [x] HTMLã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½
- [x] Google Driveã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- [x] Google Driveæ‰‹å‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
- [x] BOMé™¤å»å‡¦ç†
- [x] è‡ªå‹•æ¤œè¨¼æ©Ÿèƒ½
- [x] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### å¯è¦–åŒ–æ©Ÿèƒ½

- [x] äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—ï¼ˆãƒãƒ–ãƒ«ãƒãƒ£ãƒ¼ãƒˆã€å††ã‚°ãƒ©ãƒ•ï¼‰
- [x] è³‡æ ¼åˆ¥äººæåˆ†å¸ƒï¼ˆæ¨ªæ£’ã‚°ãƒ©ãƒ•ã€ã‚µãƒãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ï¼‰
- [x] å¹´é½¢å±¤Ã—æ€§åˆ¥ã‚¯ãƒ­ã‚¹åˆ†æï¼ˆç©ã¿ä¸Šã’æ£’ã‚°ãƒ©ãƒ•ã€ãƒ€ã‚¤ãƒãƒ¼ã‚·ãƒ†ã‚£ã‚¹ã‚³ã‚¢ï¼‰
- [x] ç§»å‹•è¨±å®¹åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ï¼ˆãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã€æ•£å¸ƒå›³ï¼‰
- [x] ãƒšãƒ«ã‚½ãƒŠè©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã€ãƒšãƒ«ã‚½ãƒŠã‚«ãƒ¼ãƒ‰ï¼‰
- [x] çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆ6ã‚¿ãƒ–ã€KPIã‚«ãƒ¼ãƒ‰ï¼‰

### ãƒ‡ãƒ¼ã‚¿ç®¡ç†

- [x] ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
- [x] ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼
- [x] ãƒ©ãƒ³ã‚¯åˆ¥å†…è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- [x] å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢

### UI/UX

- [x] ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³èƒŒæ™¯
- [x] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- [x] ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—
- [x] ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼
- [x] ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [x] å®Œå…¨å®Ÿè£…ã‚µãƒãƒªãƒ¼
- [x] HTMLã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¬ã‚¤ãƒ‰
- [x] E2Eãƒ†ã‚¹ãƒˆçµæœãƒ¬ãƒãƒ¼ãƒˆ
- [x] å®Œå…¨æ©Ÿèƒ½ä¸€è¦§ï¼ˆã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

---

## ğŸ¯ ã¾ã¨ã‚

### å®Ÿè£…è¦æ¨¡

- **åˆè¨ˆ**: 10ãƒ•ã‚¡ã‚¤ãƒ«ã€3,550è¡Œ
- **ãƒ†ã‚¹ãƒˆ**: 21ä»¶ï¼ˆ100%æˆåŠŸï¼‰
- **å“è³ªã‚¹ã‚³ã‚¢**: 100/100ç‚¹
- **æœ¬ç•ªé‹ç”¨**: å¯èƒ½

### ä¸»è¦æ©Ÿèƒ½

1. **3ã¤ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–¹æ³•** ï¼ˆHTMLã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¨å¥¨ï¼‰
2. **5ã¤ã®å€‹åˆ¥å¯è¦–åŒ–** ï¼ˆ15å€‹ã®ã‚°ãƒ©ãƒ•ï¼‰
3. **1ã¤ã®çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰** ï¼ˆ6ã‚¿ãƒ–ï¼‰
4. **4ã¤ã®ãƒ‡ãƒ¼ã‚¿ç®¡ç†æ©Ÿèƒ½**

### æŠ€è¡“çš„ç‰¹å¾´

- âœ… **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼**: ç›´æ„Ÿçš„UIã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- âœ… **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: é…å»¶ãƒ­ãƒ¼ãƒ‰ã€ãƒãƒƒãƒå‡¦ç†
- âœ… **æ‹¡å¼µæ€§**: ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¨­è¨ˆã€å†åˆ©ç”¨å¯èƒ½
- âœ… **ä¿å®ˆæ€§**: ã‚³ãƒ¡ãƒ³ãƒˆå……å®Ÿã€æ§‹é€ åŒ–ã‚³ãƒ¼ãƒ‰

---

**GASå´ã®å…¨æ©Ÿèƒ½å®Ÿè£…å®Œäº†ï¼æœ¬ç•ªé‹ç”¨å¯èƒ½ã§ã™ã€‚** âœ…
