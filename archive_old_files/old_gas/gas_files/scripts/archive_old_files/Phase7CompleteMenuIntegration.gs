/**
 * Phase 7 å®Œå…¨ç‰ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼çµ±åˆ
 *
 * æ—¢å­˜ã®GASãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«Phase 7ã®å…¨æ©Ÿèƒ½ã‚’çµ±åˆã—ã¾ã™ã€‚
 * - è‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
 * - 5ã¤ã®å€‹åˆ¥å¯è¦–åŒ–æ©Ÿèƒ½
 * - çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
 */

/**
 * ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ä½œæˆï¼ˆå®Œå…¨ç‰ˆï¼‰
 * æ—¢å­˜ã®MenuIntegration.gsã®onOpené–¢æ•°ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç½®ãæ›ãˆã¦ãã ã•ã„
 */
function onOpen_Phase7Complete() {
  const ui = SpreadsheetApp.getUi();

  // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼
  let menu = ui.createMenu('ğŸ“Š ãƒ‡ãƒ¼ã‚¿å‡¦ç†');

  // â”â”â” æ—¢å­˜ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›®ï¼ˆä¾‹ï¼‰ â”â”â”
  menu.addItem('âš¡ é«˜é€ŸCSVã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆæ¨å¥¨ï¼‰', 'showEnhancedUploadDialog');

  menu.addSeparator();

  // â”â”â” Phase 7ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆå®Œå…¨ç‰ˆï¼‰ â”â”â”
  const phase7Menu = ui.createMenu('ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ')
    // ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
    .addSubMenu(ui.createMenu('ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ')
      .addItem('ğŸ“¤ ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆå…¨7ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰', 'showPhase7BatchUploadDialog')
      .addSeparator()
      .addItem('ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆGoogle Driveï¼‰', 'quickImportLatestPhase7Data')
      .addItem('ğŸ“‚ Google Driveã‹ã‚‰è‡ªå‹•ã‚¤ãƒ³ãƒãƒ¼ãƒˆ', 'autoImportPhase7Data')
      .addSeparator()
      .addItem('ğŸ“ Phase 7ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ', 'createPhase7FolderInDrive')
      .addItem('â„¹ï¸ Google Driveãƒ•ã‚©ãƒ«ãƒ€æƒ…å ±', 'showGoogleDriveFolderInfo')
      .addSeparator()
      .addItem('âœ… ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ³ç¢ºèª', 'showPhase7UploadSummary')
    )

    .addSeparator()

    // å€‹åˆ¥å¯è¦–åŒ–æ©Ÿèƒ½
    .addSubMenu(ui.createMenu('ğŸ“Š å€‹åˆ¥åˆ†æ')
      .addItem('ğŸ—ºï¸ äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—', 'showSupplyDensityMap')
      .addItem('ğŸ“ è³‡æ ¼åˆ¥äººæåˆ†å¸ƒ', 'showQualificationDistribution')
      .addItem('ğŸ‘¥ å¹´é½¢å±¤Ã—æ€§åˆ¥ã‚¯ãƒ­ã‚¹åˆ†æ', 'showAgeGenderCrossAnalysis')
      .addItem('ğŸš— ç§»å‹•è¨±å®¹åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°', 'showMobilityScoreAnalysis')
      .addItem('ğŸ“Š ãƒšãƒ«ã‚½ãƒŠè©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«', 'showDetailedPersonaProfile')
    )

    .addSeparator()

    // çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
    .addSubMenu(ui.createMenu('ğŸ¯ çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰')
      .addItem('ğŸ“Š Phase 7çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰', 'showPhase7CompleteDashboard')
      .addItem('ğŸŒ å®Œå…¨çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆPhase 1+6+7+Networkï¼‰', 'showCompleteIntegratedDashboard')
    )

    .addSeparator()

    // ãƒ‡ãƒ¼ã‚¿ç®¡ç†
    .addSubMenu(ui.createMenu('ğŸ”§ ãƒ‡ãƒ¼ã‚¿ç®¡ç†')
      .addItem('âœ… ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼', 'validatePhase7Data')
      .addItem('ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼', 'showPhase7DataSummary')
      .addSeparator()
      .addItem('ğŸ“¤ ãƒ©ãƒ³ã‚¯åˆ¥å†…è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ', 'exportRankBreakdownToSheet')
      .addSeparator()
      .addItem('ğŸ§¹ å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢', 'clearAllPhase7Data')
    )

    .addSeparator()

    // ãƒ˜ãƒ«ãƒ—
    .addItem('â“ Phase 7ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ', 'showPhase7QuickStart');

  menu.addSubMenu(phase7Menu);

  menu.addToUi();
}


/**
 * Phase 7ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰ï¼ˆæ›´æ–°ç‰ˆï¼‰
 */
function showPhase7QuickStart() {
  const ui = SpreadsheetApp.getUi();

  const message = `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Phase 7 é«˜åº¦åˆ†ææ©Ÿèƒ½ - å®Œå…¨ç‰ˆã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€ã‚¹ãƒ†ãƒƒãƒ—1ã€‘Pythonã§ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ ğŸ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¾ãŸã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œ:
   cd "C:\\Users\\fuji1\\OneDrive\\Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆä¿ç®¡\\job_medley_project\\python_scripts"
   python run_complete.py

2. GUIãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ

3. Phase 7å‡ºåŠ›ç¢ºèªï¼ˆå…¨7ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰:
   C:\\Users\\fuji1\\OneDrive\\Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆä¿ç®¡\\job_medley_project\\gas_output_phase7\\
   â”œâ”€â”€ SupplyDensityMap.csv
   â”œâ”€â”€ QualificationDistribution.csv
   â”œâ”€â”€ AgeGenderCrossAnalysis.csv
   â”œâ”€â”€ MobilityScore.csv
   â”œâ”€â”€ DetailedPersonaProfile.csv
   â”œâ”€â”€ PersonaMapData.csv
   â””â”€â”€ PersonaMobilityCross.csv

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ã‚¹ãƒ†ãƒƒãƒ—2ã€‘GASã«ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ ğŸ“¤
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ¨ æœ€ã‚‚ç°¡å˜: ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰
  ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ > ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
          > ğŸ“¤ ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆå…¨7ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

  æ“ä½œæ‰‹é †:
  1. ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‹ã
  2. å„ã‚¨ãƒªã‚¢ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
     ï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã‚‚å¯èƒ½ï¼‰
  3. ã€Œã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
  4. å®Œäº†ï¼ï¼ˆè‡ªå‹•ã§ã‚·ãƒ¼ãƒˆä½œæˆï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ã‚¹ãƒ†ãƒƒãƒ—3ï¼ˆä»»æ„ï¼‰ã€‘Google DriveçµŒç”± ğŸ—‚ï¸
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â€» ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒä½¿ãˆãªã„å ´åˆã®ã¿

æ–¹æ³•1ï¼ˆåˆå›ã®ã¿ï¼‰: ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ
  ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ > ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
          > ğŸ“ Phase 7ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ

æ–¹æ³•2ï¼ˆ2å›ç›®ä»¥é™ï¼‰: æ—¢å­˜ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½¿ç”¨
  Google Driveã®ã€Œgas_output_phase7ã€ãƒ•ã‚©ãƒ«ãƒ€ã«
  7ã¤ã®CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

æ–¹æ³•3: ã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ï¼‰
  ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ > ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
          > ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ã‚¹ãƒ†ãƒƒãƒ—4ã€‘å¯è¦–åŒ–æ©Ÿèƒ½ã‚’ä½¿ç”¨ ğŸ“Š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ å®Œå…¨çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰:
  ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ
          > ğŸ¯ å®Œå…¨çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰

  å…¨5æ©Ÿèƒ½ã‚’ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆã§è¡¨ç¤º:
  - ğŸ“‹ æ¦‚è¦ï¼ˆKPIè¡¨ç¤ºï¼‰
  - ğŸ—ºï¸ äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—
  - ğŸ“ è³‡æ ¼åˆ¥äººæåˆ†å¸ƒ
  - ğŸ‘¥ å¹´é½¢å±¤Ã—æ€§åˆ¥ã‚¯ãƒ­ã‚¹åˆ†æ
  - ğŸš— ç§»å‹•è¨±å®¹åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°
  - ğŸ“Š ãƒšãƒ«ã‚½ãƒŠè©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«

ğŸ“Š å€‹åˆ¥åˆ†æ:
  ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ > ğŸ“Š å€‹åˆ¥åˆ†æ
  å„æ©Ÿèƒ½ã‚’å€‹åˆ¥ã«è©³ç´°è¡¨ç¤º

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã€‘ğŸ”§
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼:
  7ã¤ã®ã‚·ãƒ¼ãƒˆã®å­˜åœ¨ã¨æ•´åˆæ€§ã‚’ç¢ºèª

ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼:
  å„ã‚·ãƒ¼ãƒˆã®ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ã‚’è¡¨ç¤º

ğŸ“¤ ãƒ©ãƒ³ã‚¯åˆ¥å†…è¨³ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ:
  äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—ã®è©³ç´°ã‚’ã‚·ãƒ¼ãƒˆå‡ºåŠ›

ğŸ§¹ å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢:
  Phase 7ã®å…¨ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ãƒ“ã‚¸ãƒã‚¹æ´»ç”¨ä¾‹ã€‘ğŸ’¼
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ—ºï¸ äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ— â†’ åºƒå‘Šäºˆç®—é…åˆ†ã®æ„æ€æ±ºå®š
ğŸ“ è³‡æ ¼åˆ¥äººæåˆ†å¸ƒ â†’ ã‚¿ãƒ¼ã‚²ãƒ†ã‚£ãƒ³ã‚°åºƒå‘Šæˆ¦ç•¥
ğŸ‘¥ å¹´é½¢å±¤Ã—æ€§åˆ¥ã‚¯ãƒ­ã‚¹ â†’ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°æœ€é©åŒ–
ğŸš— ç§»å‹•è¨±å®¹åº¦ â†’ ãƒªãƒ¢ãƒ¼ãƒˆæ±‚äººæˆ¦ç•¥
ğŸ“Š ãƒšãƒ«ã‚½ãƒŠãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« â†’ å–¶æ¥­ææ¡ˆè³‡æ–™ä½œæˆ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€‘ğŸ”§
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Q: ã€Œãƒ•ã‚©ãƒ«ãƒ€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼
A: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ > ğŸ“ Phase 7ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ ã‚’å®Ÿè¡Œ

Q: ã€Œã‚·ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼
A: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ > ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆ ã‚’å®Ÿè¡Œ

Q: ã‚°ãƒ©ãƒ•ãŒè¡¨ç¤ºã•ã‚Œãªã„
A: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ > âœ… ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ ã‚’å®Ÿè¡Œ
   ãƒ–ãƒ©ã‚¦ã‚¶ã‚’ãƒªãƒ­ãƒ¼ãƒ‰ï¼ˆF5ï¼‰

Q: ãƒ‡ãƒ¼ã‚¿ãŒå¤ã„
A: Pythonã§ run_complete.py ã‚’å†å®Ÿè¡Œ
   Google Driveã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°
   ãƒ¡ãƒ‹ãƒ¥ãƒ¼ > ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ãƒãƒ¼ãƒˆ ã‚’å®Ÿè¡Œ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  `;

  ui.alert('Phase 7 å®Œå…¨ç‰ˆã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ', message, ui.ButtonSet.OK);
}
