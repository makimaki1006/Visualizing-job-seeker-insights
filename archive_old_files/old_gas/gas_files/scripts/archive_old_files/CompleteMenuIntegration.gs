/**
 * å®Œå…¨çµ±åˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆPhase 1-7 + ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ†æï¼‰
 *
 * æ—¢å­˜ã®GASãƒ¡ãƒ‹ãƒ¥ãƒ¼ã«å…¨Phaseã®æ©Ÿèƒ½ã‚’çµ±åˆã—ã¾ã™ã€‚
 *
 * ä½œæˆæ—¥: 2025-10-27
 * ãƒãƒ¼ã‚¸ãƒ§ãƒ³: 2.0ï¼ˆPhaseåˆ¥ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯¾å¿œï¼‰
 */

/**
 * ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒ‹ãƒ¥ãƒ¼ä½œæˆï¼ˆå®Œå…¨ç‰ˆï¼‰
 */
function onOpen() {
  const ui = SpreadsheetApp.getUi();

  // ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼
  let menu = ui.createMenu('ğŸ“Š ãƒ‡ãƒ¼ã‚¿å‡¦ç†');

  // â”â”â” ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ â”â”â”
  menu.addSubMenu(ui.createMenu('ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ')
    .addItem('ğŸ“ Phase 1: åŸºç¤é›†è¨ˆï¼ˆ4ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰', 'uploadPhase1')
    .addItem('ğŸ“Š Phase 2: çµ±è¨ˆåˆ†æï¼ˆ2ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰', 'uploadPhase2')
    .addItem('ğŸ‘¥ Phase 3: ãƒšãƒ«ã‚½ãƒŠåˆ†æï¼ˆ2ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰', 'uploadPhase3')
    .addItem('ğŸŒŠ Phase 6: ãƒ•ãƒ­ãƒ¼åˆ†æï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰', 'uploadPhase6')
    .addItem('ğŸ“ˆ Phase 7: é«˜åº¦åˆ†æï¼ˆ7ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰', 'uploadPhase7')
    .addSeparator()
    .addItem('âœ… å…¨Phaseã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ³', 'showAllPhasesUploadStatus')
  );

  menu.addSeparator();

  // â”â”â” Phase 7é«˜åº¦åˆ†æãƒ¡ãƒ‹ãƒ¥ãƒ¼ â”â”â”
  const phase7Menu = ui.createMenu('ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ')
    // å€‹åˆ¥å¯è¦–åŒ–æ©Ÿèƒ½
    .addSubMenu(ui.createMenu('ğŸ“Š å€‹åˆ¥åˆ†æ')
      .addItem('ğŸ—ºï¸ äººæä¾›çµ¦å¯†åº¦ãƒãƒƒãƒ—', 'showSupplyDensityMap')
      .addItem('ğŸ“ è³‡æ ¼åˆ¥äººæåˆ†å¸ƒ', 'showQualificationDistribution')
      .addItem('ğŸ‘¥ å¹´é½¢å±¤Ã—æ€§åˆ¥ã‚¯ãƒ­ã‚¹åˆ†æ', 'showAgeGenderCrossAnalysis')
      .addItem('ğŸš— ç§»å‹•è¨±å®¹åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°', 'showMobilityScoreAnalysis')
      .addItem('ğŸ“Š ãƒšãƒ«ã‚½ãƒŠè©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«', 'showDetailedPersonaProfile')
    )

    .addSeparator()

    // çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
    .addSubMenu(ui.createMenu('ğŸ¯ çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰')
      .addItem('ğŸ“Š Phase 7çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰', 'showPhase7CompleteDashboard')
      .addItem('ğŸŒ å®Œå…¨çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆPhase 1+6+7+Networkï¼‰', 'showCompleteIntegratedDashboard')
    )

    .addSeparator()

    // ãƒ‡ãƒ¼ã‚¿ç®¡ç†
    .addSubMenu(ui.createMenu('ğŸ”§ ãƒ‡ãƒ¼ã‚¿ç®¡ç†')
      .addItem('âœ… ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼', 'validatePhase7Data')
      .addItem('ğŸ“Š ãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒªãƒ¼', 'showPhase7DataSummary')
      .addSeparator()
      .addItem('ğŸ§¹ å…¨ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªã‚¢', 'clearAllPhase7Data')
    )

    .addSeparator()

    // ãƒ˜ãƒ«ãƒ—
    .addItem('â“ Phase 7ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ', 'showPhase7QuickStart');

  menu.addSubMenu(phase7Menu);

  menu.addSeparator();

  // â”â”â” ãã®ä»–ã®æ©Ÿèƒ½ â”â”â”
  menu.addItem('ğŸ—ºï¸ åœ°å›³è¡¨ç¤ºï¼ˆãƒãƒ–ãƒ«ï¼‰', 'showBubbleMap');
  menu.addItem('ğŸ“ åœ°å›³è¡¨ç¤ºï¼ˆãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ï¼‰', 'showHeatMap');

  menu.addToUi();
}

/**
 * Phaseåˆ¥ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–¢æ•°
 */
function uploadPhase1() {
  showPhaseUploadDialog('phase1');
}

function uploadPhase2() {
  showPhaseUploadDialog('phase2');
}

function uploadPhase3() {
  showPhaseUploadDialog('phase3');
}

function uploadPhase6() {
  showPhaseUploadDialog('phase6');
}

function uploadPhase7() {
  showPhaseUploadDialog('phase7');
}

/**
 * ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰ï¼ˆæ›´æ–°ç‰ˆï¼‰
 */
function showPhase7QuickStart() {
  const ui = SpreadsheetApp.getUi();

  const message = `
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Phase 1-7 å®Œå…¨ç‰ˆã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ã€ã‚¹ãƒ†ãƒƒãƒ—1ã€‘Pythonã§ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ ğŸ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¾ãŸã¯ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œ:
   cd "C:\\Users\\fuji1\\OneDrive\\Pythonã‚¹ã‚¯ãƒªãƒ—ãƒˆä¿ç®¡\\job_medley_project\\python_scripts"
   python run_complete.py

2. GUIãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ

3. å‡ºåŠ›ç¢ºèª:
   Phase 1: gas_output_phase1 (4ãƒ•ã‚¡ã‚¤ãƒ«)
   Phase 2: gas_output_phase2 (2ãƒ•ã‚¡ã‚¤ãƒ«)
   Phase 3: gas_output_phase3 (2ãƒ•ã‚¡ã‚¤ãƒ«)
   Phase 6: gas_output_phase6 (3ãƒ•ã‚¡ã‚¤ãƒ«)
   Phase 7: gas_output_phase7 (7ãƒ•ã‚¡ã‚¤ãƒ«)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ã‚¹ãƒ†ãƒƒãƒ—2ã€‘GASã«ä¸€æ‹¬ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ ğŸ“¤
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ğŸ“Š ãƒ‡ãƒ¼ã‚¿å‡¦ç† > ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

Phaseåˆ¥ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰:
  ğŸ“ Phase 1: åŸºç¤é›†è¨ˆï¼ˆ4ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
  ğŸ“Š Phase 2: çµ±è¨ˆåˆ†æï¼ˆ2ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
  ğŸ‘¥ Phase 3: ãƒšãƒ«ã‚½ãƒŠåˆ†æï¼ˆ2ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
  ğŸŒŠ Phase 6: ãƒ•ãƒ­ãƒ¼åˆ†æï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
  ğŸ“ˆ Phase 7: é«˜åº¦åˆ†æï¼ˆ7ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

æ“ä½œæ‰‹é †ï¼ˆå„Phaseå…±é€šï¼‰:
  1. ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‹ã
  2. å„ã‚¨ãƒªã‚¢ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
     ï¼ˆãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã‚‚å¯èƒ½ï¼‰
  3. ã€Œã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–‹å§‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
  4. å®Œäº†ï¼ï¼ˆè‡ªå‹•ã§ã‚·ãƒ¼ãƒˆä½œæˆï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ã‚¹ãƒ†ãƒƒãƒ—3ã€‘å¯è¦–åŒ–æ©Ÿèƒ½ã‚’ä½¿ç”¨ ğŸ“Š
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ¯ å®Œå…¨çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰:
  ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ğŸ“ˆ Phase 7é«˜åº¦åˆ†æ
          > ğŸ¯ çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
          > ğŸŒ å®Œå…¨çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆPhase 1+6+7+Networkï¼‰

  å…¨æ©Ÿèƒ½ã‚’ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆã§è¡¨ç¤º:
  - ğŸ“Š çµ±åˆæ¦‚è¦
  - ğŸ“ Phase 1: åŸºç¤é›†è¨ˆ
  - ğŸŒŠ Phase 6: ãƒ•ãƒ­ãƒ¼åˆ†æ
  - ğŸ”— ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸­å¿ƒæ€§
  - ğŸ—ºï¸ Phase 7: ä¾›çµ¦å¯†åº¦
  - ğŸ“ Phase 7: è³‡æ ¼åˆ†å¸ƒ
  - ğŸ‘¥ Phase 7: å¹´é½¢Ã—æ€§åˆ¥
  - ğŸš— Phase 7: ç§»å‹•è¨±å®¹åº¦
  - ğŸ“‹ Phase 7: ãƒšãƒ«ã‚½ãƒŠ

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ³ç¢ºèªã€‘âœ…
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ãƒ¡ãƒ‹ãƒ¥ãƒ¼: ğŸ“Š ãƒ‡ãƒ¼ã‚¿å‡¦ç† > ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        > âœ… å…¨Phaseã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ³

å…¨18ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰çŠ¶æ³ã‚’ä¸€è¦§è¡¨ç¤º

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€‘ğŸ”§
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Q: ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œãªã„
A: Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’å®Œå…¨ã«é–‰ã˜ã¦å†åº¦é–‹ã

Q: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ãŒç„¡åŠ¹ã®ã¾ã¾
A: å…¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

Q: ã‚·ãƒ¼ãƒˆãŒä½œæˆã•ã‚Œãªã„
A: GASã‚¨ãƒ‡ã‚£ã‚¿ã®ãƒ­ã‚°ã‚’ç¢ºèªï¼ˆè¡¨ç¤º > ãƒ­ã‚°ï¼‰

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  `;

  ui.alert('Phase 1-7 å®Œå…¨ç‰ˆã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ', message, ui.ButtonSet.OK);
}
