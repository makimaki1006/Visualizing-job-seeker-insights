<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>GAS Webã‚¢ãƒ—ãƒªæ¥ç¶šãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #0d1525;
            color: #f8fafc;
        }
        h1 {
            color: #0072B2;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            background: rgba(15, 23, 42, 0.82);
            border: 1px solid rgba(148, 163, 184, 0.22);
            border-radius: 8px;
        }
        iframe {
            width: 100%;
            height: 800px;
            border: 1px solid rgba(148, 163, 184, 0.22);
            border-radius: 8px;
            background: white;
        }
        .url-info {
            margin: 10px 0;
            padding: 10px;
            background: rgba(12, 20, 37, 0.95);
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            word-break: break-all;
        }
        .status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .status.loading {
            background: rgba(230, 159, 0, 0.2);
            color: #E69F00;
        }
        .status.success {
            background: rgba(0, 114, 178, 0.2);
            color: #0072B2;
        }
        .status.error {
            background: rgba(213, 94, 0, 0.2);
            color: #D55E00;
        }
        button {
            padding: 10px 20px;
            background: #0072B2;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
        }
        button:hover {
            background: #005a8e;
        }
    </style>
</head>
<body>
    <h1>ğŸ—ºï¸ GAS Webã‚¢ãƒ—ãƒªæ¥ç¶šãƒ†ã‚¹ãƒˆ</h1>

    <div class="test-section">
        <h2>ãƒ†ã‚¹ãƒˆå¯¾è±¡URL</h2>
        <div class="url-info" id="current-url"></div>

        <h3>ãƒ†ã‚¹ãƒˆæ–¹æ³•</h3>
        <button onclick="testURL1()">@HEAD URLã‚’ãƒ†ã‚¹ãƒˆ</button>
        <button onclick="testURL2()">@1 URLã‚’ãƒ†ã‚¹ãƒˆ</button>
        <button onclick="testURL3()">@2 URLã‚’ãƒ†ã‚¹ãƒˆï¼ˆiframeå¯¾å¿œç‰ˆï¼‰</button>
        <button onclick="testURL4()" style="background: #D55E00;">@3 URLã‚’ãƒ†ã‚¹ãƒˆï¼ˆè¡¨ç¤ºä¿®æ­£ç‰ˆï¼‰ğŸ”¥</button>
        <button onclick="openInNewTab()">æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã</button>

        <div id="status" class="status loading">èª­ã¿è¾¼ã¿æº–å‚™ä¸­...</div>
    </div>

    <div class="test-section">
        <h2>iframeåŸ‹ã‚è¾¼ã¿ãƒ†ã‚¹ãƒˆ</h2>
        <iframe id="gas-iframe" allow="geolocation"></iframe>
    </div>

    <script>
        // ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆURL
        const URL_HEAD = "https://script.google.com/macros/s/AKfycbxBK5gRmDCuetK7bOp5IuLEFR1bnmsxPrIyYewgIYY/exec";
        const URL_V1 = "https://script.google.com/macros/s/AKfycbwyUrJf_aJTN-UYj_CONbwXOB9fhp3Z7sb9X8Yt7UtwfOCuKf6avXoziE38OOkRryIQ/exec";
        const URL_V2_IFRAME = "https://script.google.com/macros/s/AKfycbx6YxrvTDY0jxML3GfGigNj27Pcgr2cavyrKzEimWLBVjBMlZ2u1a0oVzvyz3o7U-yi/exec"; // iframeå¯¾å¿œç‰ˆ
        const URL_V3_FIXED = "https://script.google.com/macros/s/AKfycbw0zV33_fSV8NCqG1A2qXNqRATXC53YdSO7FZzUEcjLf5ycwf6PAH60RnGwEKHHvIUp/exec"; // è©³ç´°ãƒ‘ãƒãƒ«åˆæœŸéè¡¨ç¤ºç‰ˆ

        let currentURL = URL_HEAD;

        function updateStatus(message, type) {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = 'status ' + type;
        }

        function updateCurrentURL(url) {
            currentURL = url;
            document.getElementById('current-url').textContent = url;
            document.getElementById('gas-iframe').src = url;
        }

        function testURL1() {
            updateStatus('@HEAD URLã‚’ãƒ†ã‚¹ãƒˆä¸­...', 'loading');
            updateCurrentURL(URL_HEAD);
            setTimeout(() => {
                updateStatus('@HEAD URLè¨­å®šå®Œäº†ã€‚ä¸Šè¨˜ã®iframeã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚', 'success');
            }, 1000);
        }

        function testURL2() {
            updateStatus('@1 URLã‚’ãƒ†ã‚¹ãƒˆä¸­...', 'loading');
            updateCurrentURL(URL_V1);
            setTimeout(() => {
                updateStatus('@1 URLè¨­å®šå®Œäº†ã€‚ä¸Šè¨˜ã®iframeã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚', 'success');
            }, 1000);
        }

        function testURL3() {
            updateStatus('@2 URLï¼ˆiframeå¯¾å¿œç‰ˆï¼‰ã‚’ãƒ†ã‚¹ãƒˆä¸­... âœ¨', 'loading');
            updateCurrentURL(URL_V2_IFRAME);
            setTimeout(() => {
                updateStatus('âœ… @2 URLï¼ˆiframeå¯¾å¿œç‰ˆï¼‰è¨­å®šå®Œäº†ã€‚ä¸Šè¨˜ã®iframeã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚', 'success');
            }, 1000);
        }

        function testURL4() {
            updateStatus('@3 URLï¼ˆè¡¨ç¤ºä¿®æ­£ç‰ˆï¼‰ã‚’ãƒ†ã‚¹ãƒˆä¸­... ğŸ”¥', 'loading');
            updateCurrentURL(URL_V3_FIXED);
            setTimeout(() => {
                updateStatus('âœ… @3 URLï¼ˆè¡¨ç¤ºä¿®æ­£ç‰ˆï¼‰è¨­å®šå®Œäº†ã€‚åœ°å›³ãŒå…¨å¹…è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚', 'success');
            }, 1000);
        }

        function openInNewTab() {
            window.open(currentURL, '_blank');
        }

        // iframeèª­ã¿è¾¼ã¿æ¤œçŸ¥
        const iframe = document.getElementById('gas-iframe');
        iframe.addEventListener('load', function() {
            updateStatus('âœ… iframeãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸï¼', 'success');
        });

        iframe.addEventListener('error', function() {
            updateStatus('âŒ iframeèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ã€‚æ¥ç¶šãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸã€‚', 'error');
        });

        // åˆæœŸURLè¨­å®š
        window.addEventListener('load', function() {
            testURL1();
        });
    </script>
</body>
</html>
